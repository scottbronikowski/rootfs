<html lang="en">
<head>
<title>Fitting Overview - GNU Scientific Library -- Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Scientific Library -- Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Least_002dSquares-Fitting.html" title="Least-Squares Fitting">
<link rel="next" href="Linear-regression.html" title="Linear regression">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 The GSL Team.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'' and ``Free Software
Needs Free Documentation'', the Front-Cover text being ``A GNU Manual'',
and with the Back-Cover Text being (a) (see below).  A copy of the
license is included in the section entitled ``GNU Free Documentation
License''.

(a) The Back-Cover Text is: ``You have the freedom to copy and modify this
GNU Manual.''-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Fitting-Overview"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Linear-regression.html">Linear regression</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Least_002dSquares-Fitting.html">Least-Squares Fitting</a>
<hr>
</div>

<h3 class="section">37.1 Overview</h3>

<p>Least-squares fits are found by minimizing \chi^2
(chi-squared), the weighted sum of squared residuals over n
experimental datapoints (x_i, y_i) for the model Y(c,x),
The p parameters of the model are <!-- {$c = \{c_0, c_1, \dots\}$} -->
c = {c_0, c_1, <small class="dots">...</small>}.  The
weight factors w_i are given by w_i = 1/\sigma_i^2,
where \sigma_i is the experimental error on the data-point
y_i.  The errors are assumed to be
Gaussian and uncorrelated. 
For unweighted data the chi-squared sum is computed without any weight factors.

   <p>The fitting routines return the best-fit parameters c and their
p \times p covariance matrix.  The covariance matrix measures the
statistical errors on the best-fit parameters resulting from the
errors on the data, \sigma_i, and is defined
<a name="index-covariance-matrix_002c-linear-fits-2565"></a>as <!-- {$C_{ab} = \langle \delta c_a \delta c_b \rangle$} -->
C_{ab} = &lt;\delta c_a \delta c_b&gt; where <!-- {$\langle \, \rangle$} -->
&lt; &gt; denotes an average over the Gaussian error distributions of the underlying datapoints.

   <p>The covariance matrix is calculated by error propagation from the data
errors \sigma_i.  The change in a fitted parameter \delta
c_a caused by a small change in the data \delta y_i is given
by
allowing the covariance matrix to be written in terms of the errors on the data,
For uncorrelated data the fluctuations of the underlying datapoints satisfy
<!-- {$\langle \delta y_i \delta y_j \rangle = \sigma_i^2 \delta_{ij}$} -->
&lt;\delta y_i \delta y_j&gt; = \sigma_i^2 \delta_{ij}, giving a
corresponding parameter covariance matrix of
When computing the covariance matrix for unweighted data, i.e. data with unknown errors,
the weight factors w_i in this sum are replaced by the single estimate w =
1/\sigma^2, where \sigma^2 is the computed variance of the
residuals about the best-fit model, \sigma^2 = \sum (y_i - Y(c,x_i))^2 / (n-p). 
This is referred to as the <dfn>variance-covariance matrix</dfn>. 
<a name="index-variance_002dcovariance-matrix_002c-linear-fits-2566"></a>
The standard deviations of the best-fit parameters are given by the
square root of the corresponding diagonal elements of
the covariance matrix, <!-- {$\sigma_{c_a} = \sqrt{C_{aa}}$} -->
\sigma_{c_a} = \sqrt{C_{aa}}. 
The correlation coefficient of the fit parameters c_a and c_b
is given by <!-- {$\rho_{ab} = C_{ab} / \sqrt{C_{aa} C_{bb}}$} -->
\rho_{ab} = C_{ab} / \sqrt{C_{aa} C_{bb}}.

<hr>The GNU Scientific Library - a free numerical library licensed under the GNU GPL<br>Back to the <a href="/software/gsl/">GNU Scientific Library Homepage</a></body></html>

