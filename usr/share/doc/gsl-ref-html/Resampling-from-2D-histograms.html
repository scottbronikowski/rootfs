<html lang="en">
<head>
<title>Resampling from 2D histograms - GNU Scientific Library -- Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Scientific Library -- Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Histograms.html" title="Histograms">
<link rel="prev" href="Reading-and-writing-2D-histograms.html" title="Reading and writing 2D histograms">
<link rel="next" href="Example-programs-for-2D-histograms.html" title="Example programs for 2D histograms">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 The GSL Team.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'' and ``Free Software
Needs Free Documentation'', the Front-Cover text being ``A GNU Manual'',
and with the Back-Cover Text being (a) (see below).  A copy of the
license is included in the section entitled ``GNU Free Documentation
License''.

(a) The Back-Cover Text is: ``You have the freedom to copy and modify this
GNU Manual.''-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Resampling-from-2D-histograms"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Example-programs-for-2D-histograms.html">Example programs for 2D histograms</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Reading-and-writing-2D-histograms.html">Reading and writing 2D histograms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Histograms.html">Histograms</a>
<hr>
</div>

<h3 class="section">22.21 Resampling from 2D histograms</h3>

<p>As in the one-dimensional case, a two-dimensional histogram made by
counting events can be regarded as a measurement of a probability
distribution.  Allowing for statistical error, the height of each bin
represents the probability of an event where (x,y) falls in
the range of that bin.  For a two-dimensional histogram the probability
distribution takes the form p(x,y) dx dy where,
In this equation
<!-- {$n_{ij}$} -->
n_{ij} is the number of events in the bin which
contains (x,y),
<!-- {$A_{ij}$} -->
A_{ij} is the area of the bin and N is
the total number of events.  The distribution of events within each bin
is assumed to be uniform.

<div class="defun">
&mdash; Data Type: <b>gsl_histogram2d_pdf</b><var><a name="index-gsl_005fhistogram2d_005fpdf-2076"></a></var><br>
<blockquote><dl>
<dt><code>size_t nx, ny</code><dd>This is the number of histogram bins used to approximate the probability
distribution function in the x and y directions. 
<br><dt><code>double * xrange</code><dd>The ranges of the bins in the x-direction are stored in an array of
<var>nx</var> + 1 elements pointed to by <var>xrange</var>. 
<br><dt><code>double * yrange</code><dd>The ranges of the bins in the y-direction are stored in an array of
<var>ny</var> + 1 pointed to by <var>yrange</var>. 
<br><dt><code>double * sum</code><dd>The cumulative probability for the bins is stored in an array of
<var>nx</var>*<var>ny</var> elements pointed to by <var>sum</var>. 
</dl>
        </p></blockquote></div>

<p class="noindent">The following functions allow you to create a <code>gsl_histogram2d_pdf</code>
struct which represents a two dimensional probability distribution and
generate random samples from it.

<div class="defun">
&mdash; Function: gsl_histogram2d_pdf * <b>gsl_histogram2d_pdf_alloc</b> (<var>size_t nx, size_t ny</var>)<var><a name="index-gsl_005fhistogram2d_005fpdf_005falloc-2077"></a></var><br>
<blockquote><p>This function allocates memory for a two-dimensional probability
distribution of size <var>nx</var>-by-<var>ny</var> and returns a pointer to a
newly initialized <code>gsl_histogram2d_pdf</code> struct. If insufficient
memory is available a null pointer is returned and the error handler is
invoked with an error code of <code>GSL_ENOMEM</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>gsl_histogram2d_pdf_init</b> (<var>gsl_histogram2d_pdf * p, const gsl_histogram2d * h</var>)<var><a name="index-gsl_005fhistogram2d_005fpdf_005finit-2078"></a></var><br>
<blockquote><p>This function initializes the two-dimensional probability distribution
calculated <var>p</var> from the histogram <var>h</var>.  If any of the bins of
<var>h</var> are negative then the error handler is invoked with an error
code of <code>GSL_EDOM</code> because a probability distribution cannot
contain negative values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>gsl_histogram2d_pdf_free</b> (<var>gsl_histogram2d_pdf * p</var>)<var><a name="index-gsl_005fhistogram2d_005fpdf_005ffree-2079"></a></var><br>
<blockquote><p>This function frees the two-dimensional probability distribution
function <var>p</var> and all of the memory associated with it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>gsl_histogram2d_pdf_sample</b> (<var>const gsl_histogram2d_pdf * p, double r1, double r2, double * x, double * y</var>)<var><a name="index-gsl_005fhistogram2d_005fpdf_005fsample-2080"></a></var><br>
<blockquote><p>This function uses two uniform random numbers between zero and one,
<var>r1</var> and <var>r2</var>, to compute a single random sample from the
two-dimensional probability distribution <var>p</var>. 
</p></blockquote></div>

<hr>The GNU Scientific Library - a free numerical library licensed under the GNU GPL<br>Back to the <a href="/software/gsl/">GNU Scientific Library Homepage</a></body></html>

