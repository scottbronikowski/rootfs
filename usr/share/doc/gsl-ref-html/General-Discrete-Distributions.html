<html lang="en">
<head>
<title>General Discrete Distributions - GNU Scientific Library -- Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Scientific Library -- Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Random-Number-Distributions.html" title="Random Number Distributions">
<link rel="prev" href="The-Dirichlet-Distribution.html" title="The Dirichlet Distribution">
<link rel="next" href="The-Poisson-Distribution.html" title="The Poisson Distribution">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 The GSL Team.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'' and ``Free Software
Needs Free Documentation'', the Front-Cover text being ``A GNU Manual'',
and with the Back-Cover Text being (a) (see below).  A copy of the
license is included in the section entitled ``GNU Free Documentation
License''.

(a) The Back-Cover Text is: ``You have the freedom to copy and modify this
GNU Manual.''-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="General-Discrete-Distributions"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="The-Poisson-Distribution.html">The Poisson Distribution</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="The-Dirichlet-Distribution.html">The Dirichlet Distribution</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Random-Number-Distributions.html">Random Number Distributions</a>
<hr>
</div>

<h3 class="section">20.28 General Discrete Distributions</h3>

<p>Given K discrete events with different probabilities P[k],
produce a random value k consistent with its probability.

   <p>The obvious way to do this is to preprocess the probability list by
generating a cumulative probability array with K+1 elements:
Note that this construction produces C[K]=1.  Now choose a
uniform deviate u between 0 and 1, and find the value of k
such that <!-- {$C[k] \le u < C[k+1]$} -->
C[k] &lt;= u &lt; C[k+1]. 
Although this in principle requires of order \log K steps per
random number generation, they are fast steps, and if you use something
like \lfloor uK \rfloor as a starting point, you can often do
pretty well.

   <p>But faster methods have been devised.  Again, the idea is to preprocess
the probability list, and save the result in some form of lookup table;
then the individual calls for a random discrete event can go rapidly. 
An approach invented by G. Marsaglia (Generating discrete random variables
in a computer, Comm ACM 6, 37&ndash;38 (1963)) is very clever, and readers
interested in examples of good algorithm design are directed to this
short and well-written paper.  Unfortunately, for large K,
Marsaglia's lookup table can be quite large.

   <p>A much better approach is due to Alastair J. Walker (An efficient method
for generating discrete random variables with general distributions, ACM
Trans on Mathematical Software 3, 253&ndash;256 (1977); see also Knuth, v2,
3rd ed, p120&ndash;121,139).  This requires two lookup tables, one floating
point and one integer, but both only of size K.  After
preprocessing, the random numbers are generated in O(1) time, even for
large K.  The preprocessing suggested by Walker requires
O(K^2) effort, but that is not actually necessary, and the
implementation provided here only takes O(K) effort.  In general,
more preprocessing leads to faster generation of the individual random
numbers, but a diminishing return is reached pretty early.  Knuth points
out that the optimal preprocessing is combinatorially difficult for
large K.

   <p>This method can be used to speed up some of the discrete random number
generators below, such as the binomial distribution.  To use it for
something like the Poisson Distribution, a modification would have to
be made, since it only takes a finite set of K outcomes.

<div class="defun">
&mdash; Function: gsl_ran_discrete_t * <b>gsl_ran_discrete_preproc</b> (<var>size_t K, const double * P</var>)<var><a name="index-gsl_005fran_005fdiscrete_005fpreproc-1868"></a></var><br>
<blockquote><p><a name="index-gsl_005fran_005fdiscrete_005ft-1869"></a><a name="index-Discrete-random-numbers-1870"></a><a name="index-Discrete-random-numbers_002c-preprocessing-1871"></a>This function returns a pointer to a structure that contains the lookup
table for the discrete random number generator.  The array <var>P</var>[] contains
the probabilities of the discrete events; these array elements must all be
positive, but they needn't add up to one (so you can think of them more
generally as &ldquo;weights&rdquo;)&mdash;the preprocessor will normalize appropriately. 
This return value is used
as an argument for the <code>gsl_ran_discrete</code> function below. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: size_t <b>gsl_ran_discrete</b> (<var>const gsl_rng * r, const gsl_ran_discrete_t * g</var>)<var><a name="index-gsl_005fran_005fdiscrete-1872"></a></var><br>
<blockquote><p><a name="index-Discrete-random-numbers-1873"></a>After the preprocessor, above, has been called, you use this function to
get the discrete random numbers. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: double <b>gsl_ran_discrete_pdf</b> (<var>size_t k, const gsl_ran_discrete_t * g</var>)<var><a name="index-gsl_005fran_005fdiscrete_005fpdf-1874"></a></var><br>
<blockquote><p><a name="index-Discrete-random-numbers-1875"></a>Returns the probability P[k] of observing the variable <var>k</var>. 
Since P[k] is not stored as part of the lookup table, it must be
recomputed; this computation takes O(K), so if <var>K</var> is large
and you care about the original array P[k] used to create the
lookup table, then you should just keep this original array P[k]
around. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>gsl_ran_discrete_free</b> (<var>gsl_ran_discrete_t * g</var>)<var><a name="index-gsl_005fran_005fdiscrete_005ffree-1876"></a></var><br>
<blockquote><p><a name="index-Discrete-random-numbers-1877"></a>De-allocates the lookup table pointed to by <var>g</var>. 
</p></blockquote></div>

<hr>The GNU Scientific Library - a free numerical library licensed under the GNU GPL<br>Back to the <a href="/software/gsl/">GNU Scientific Library Homepage</a></body></html>

