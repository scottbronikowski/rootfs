<html lang="en">
<head>
<title>Example programs for matrices - GNU Scientific Library -- Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Scientific Library -- Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Matrices.html" title="Matrices">
<link rel="prev" href="Matrix-properties.html" title="Matrix properties">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 The GSL Team.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'' and ``Free Software
Needs Free Documentation'', the Front-Cover text being ``A GNU Manual'',
and with the Back-Cover Text being (a) (see below).  A copy of the
license is included in the section entitled ``GNU Free Documentation
License''.

(a) The Back-Cover Text is: ``You have the freedom to copy and modify this
GNU Manual.''-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Example-programs-for-matrices"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Matrix-properties.html">Matrix properties</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Matrices.html">Matrices</a>
<hr>
</div>

<h4 class="subsection">8.4.13 Example programs for matrices</h4>

<p>The program below shows how to allocate, initialize and read from a matrix
using the functions <code>gsl_matrix_alloc</code>, <code>gsl_matrix_set</code> and
<code>gsl_matrix_get</code>.

<pre class="example"><pre class="verbatim">     #include &lt;stdio.h>
     #include &lt;gsl/gsl_matrix.h>
     
     int
     main (void)
     {
       int i, j; 
       gsl_matrix * m = gsl_matrix_alloc (10, 3);
       
       for (i = 0; i &lt; 10; i++)
         for (j = 0; j &lt; 3; j++)
           gsl_matrix_set (m, i, j, 0.23 + 100*i + j);
       
       for (i = 0; i &lt; 100; i++)  /* OUT OF RANGE ERROR */
         for (j = 0; j &lt; 3; j++)
           printf ("m(%d,%d) = %g\n", i, j, 
                   gsl_matrix_get (m, i, j));
     
       gsl_matrix_free (m);
     
       return 0;
     }
</pre></pre>
   <p class="noindent">Here is the output from the program.  The final loop attempts to read
outside the range of the matrix <code>m</code>, and the error is trapped by
the range-checking code in <code>gsl_matrix_get</code>.

<pre class="example">     $ ./a.out
     m(0,0) = 0.23
     m(0,1) = 1.23
     m(0,2) = 2.23
     m(1,0) = 100.23
     m(1,1) = 101.23
     m(1,2) = 102.23
     ...
     m(9,2) = 902.23
     gsl: matrix_source.c:13: ERROR: first index out of range
     Default GSL error handler invoked.
     Aborted (core dumped)
</pre>
   <p class="noindent">The next program shows how to write a matrix to a file.

<pre class="example"><pre class="verbatim">     #include &lt;stdio.h>
     #include &lt;gsl/gsl_matrix.h>
     
     int
     main (void)
     {
       int i, j, k = 0; 
       gsl_matrix * m = gsl_matrix_alloc (100, 100);
       gsl_matrix * a = gsl_matrix_alloc (100, 100);
       
       for (i = 0; i &lt; 100; i++)
         for (j = 0; j &lt; 100; j++)
           gsl_matrix_set (m, i, j, 0.23 + i + j);
     
       {  
          FILE * f = fopen ("test.dat", "wb");
          gsl_matrix_fwrite (f, m);
          fclose (f);
       }
     
       {  
          FILE * f = fopen ("test.dat", "rb");
          gsl_matrix_fread (f, a);
          fclose (f);
       }
     
       for (i = 0; i &lt; 100; i++)
         for (j = 0; j &lt; 100; j++)
           {
             double mij = gsl_matrix_get (m, i, j);
             double aij = gsl_matrix_get (a, i, j);
             if (mij != aij) k++;
           }
     
       gsl_matrix_free (m);
       gsl_matrix_free (a);
     
       printf ("differences = %d (should be zero)\n", k);
       return (k > 0);
     }
</pre></pre>
   <p class="noindent">After running this program the file <samp><span class="file">test.dat</span></samp> should contain the
elements of <code>m</code>, written in binary format.  The matrix which is read
back in using the function <code>gsl_matrix_fread</code> should be exactly
equal to the original matrix.

   <p>The following program demonstrates the use of vector views.  The program
computes the column norms of a matrix.

<pre class="example"><pre class="verbatim">     #include &lt;math.h>
     #include &lt;stdio.h>
     #include &lt;gsl/gsl_matrix.h>
     #include &lt;gsl/gsl_blas.h>
     
     int
     main (void)
     {
       size_t i,j;
     
       gsl_matrix *m = gsl_matrix_alloc (10, 10);
     
       for (i = 0; i &lt; 10; i++)
         for (j = 0; j &lt; 10; j++)
           gsl_matrix_set (m, i, j, sin (i) + cos (j));
     
       for (j = 0; j &lt; 10; j++)
         {
           gsl_vector_view column = gsl_matrix_column (m, j);
           double d;
     
           d = gsl_blas_dnrm2 (&amp;column.vector);
     
           printf ("matrix column %d, norm = %g\n", j, d);
         }
     
       gsl_matrix_free (m);
     
       return 0;
     }
</pre></pre>
   <p class="noindent">Here is the output of the program,

<pre class="example">     $ ./a.out
<pre class="verbatim">     matrix column 0, norm = 4.31461
     matrix column 1, norm = 3.1205
     matrix column 2, norm = 2.19316
     matrix column 3, norm = 3.26114
     matrix column 4, norm = 2.53416
     matrix column 5, norm = 2.57281
     matrix column 6, norm = 4.20469
     matrix column 7, norm = 3.65202
     matrix column 8, norm = 2.08524
     matrix column 9, norm = 3.07313
</pre></pre>
   <p class="noindent">The results can be confirmed using <span class="sc">gnu octave</span>,

<pre class="example">     $ octave
     GNU Octave, version 2.0.16.92
     octave&gt; m = sin(0:9)' * ones(1,10)
                    + ones(10,1) * cos(0:9);
     octave&gt; sqrt(sum(m.^2))
     ans =
       4.3146  3.1205  2.1932  3.2611  2.5342  2.5728
       4.2047  3.6520  2.0852  3.0731
</pre>
<hr>The GNU Scientific Library - a free numerical library licensed under the GNU GPL<br>Back to the <a href="/software/gsl/">GNU Scientific Library Homepage</a></body></html>

