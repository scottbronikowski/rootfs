<html lang="en">
<head>
<title>The histogram probability distribution struct - GNU Scientific Library -- Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Scientific Library -- Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Histograms.html" title="Histograms">
<link rel="prev" href="Resampling-from-histograms.html" title="Resampling from histograms">
<link rel="next" href="Example-programs-for-histograms.html" title="Example programs for histograms">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 The GSL Team.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'' and ``Free Software
Needs Free Documentation'', the Front-Cover text being ``A GNU Manual'',
and with the Back-Cover Text being (a) (see below).  A copy of the
license is included in the section entitled ``GNU Free Documentation
License''.

(a) The Back-Cover Text is: ``You have the freedom to copy and modify this
GNU Manual.''-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="The-histogram-probability-distribution-struct"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Example-programs-for-histograms.html">Example programs for histograms</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Resampling-from-histograms.html">Resampling from histograms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Histograms.html">Histograms</a>
<hr>
</div>

<h3 class="section">22.10 The histogram probability distribution struct</h3>

<p><a name="index-probability-distribution_002c-from-histogram-2024"></a><a name="index-sampling-from-histograms-2025"></a><a name="index-random-sampling-from-histograms-2026"></a><a name="index-histograms_002c-random-sampling-from-2027"></a>The probability distribution function for a histogram consists of a set
of <dfn>bins</dfn> which measure the probability of an event falling into a
given range of a continuous variable x. A probability
distribution function is defined by the following struct, which actually
stores the cumulative probability distribution function.  This is the
natural quantity for generating samples via the inverse transform
method, because there is a one-to-one mapping between the cumulative
probability distribution and the range [0,1].  It can be shown that by
taking a uniform random number in this range and finding its
corresponding coordinate in the cumulative probability distribution we
obtain samples with the desired probability distribution.

<div class="defun">
&mdash; Data Type: <b>gsl_histogram_pdf</b><var><a name="index-gsl_005fhistogram_005fpdf-2028"></a></var><br>
<blockquote><dl>
<dt><code>size_t n</code><dd>This is the number of bins used to approximate the probability
distribution function. 
<br><dt><code>double * range</code><dd>The ranges of the bins are stored in an array of <var>n</var>+1 elements
pointed to by <var>range</var>. 
<br><dt><code>double * sum</code><dd>The cumulative probability for the bins is stored in an array of
<var>n</var> elements pointed to by <var>sum</var>. 
</dl>
        </p></blockquote></div>

<p class="noindent">The following functions allow you to create a <code>gsl_histogram_pdf</code>
struct which represents this probability distribution and generate
random samples from it.

<div class="defun">
&mdash; Function: gsl_histogram_pdf * <b>gsl_histogram_pdf_alloc</b> (<var>size_t n</var>)<var><a name="index-gsl_005fhistogram_005fpdf_005falloc-2029"></a></var><br>
<blockquote><p>This function allocates memory for a probability distribution with
<var>n</var> bins and returns a pointer to a newly initialized
<code>gsl_histogram_pdf</code> struct. If insufficient memory is available a
null pointer is returned and the error handler is invoked with an error
code of <code>GSL_ENOMEM</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>gsl_histogram_pdf_init</b> (<var>gsl_histogram_pdf * p, const gsl_histogram * h</var>)<var><a name="index-gsl_005fhistogram_005fpdf_005finit-2030"></a></var><br>
<blockquote><p>This function initializes the probability distribution <var>p</var> with
the contents of the histogram <var>h</var>. If any of the bins of <var>h</var> are
negative then the error handler is invoked with an error code of
<code>GSL_EDOM</code> because a probability distribution cannot contain
negative values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>gsl_histogram_pdf_free</b> (<var>gsl_histogram_pdf * p</var>)<var><a name="index-gsl_005fhistogram_005fpdf_005ffree-2031"></a></var><br>
<blockquote><p>This function frees the probability distribution function <var>p</var> and
all of the memory associated with it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: double <b>gsl_histogram_pdf_sample</b> (<var>const gsl_histogram_pdf * p, double r</var>)<var><a name="index-gsl_005fhistogram_005fpdf_005fsample-2032"></a></var><br>
<blockquote><p>This function uses <var>r</var>, a uniform random number between zero and
one, to compute a single random sample from the probability distribution
<var>p</var>.  The algorithm used to compute the sample s is given by
the following formula,
     where i is the index which satisfies
<!-- {$sum[i] \le  r < sum[i+1]$} -->
sum[i] &lt;=  r &lt; sum[i+1] and
delta is
<!-- {$(r - sum[i])/(sum[i+1] - sum[i])$} -->
(r - sum[i])/(sum[i+1] - sum[i]). 
</p></blockquote></div>

<hr>The GNU Scientific Library - a free numerical library licensed under the GNU GPL<br>Back to the <a href="/software/gsl/">GNU Scientific Library Homepage</a></body></html>

