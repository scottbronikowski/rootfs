<html lang="en">
<head>
<title>QAG adaptive integration - GNU Scientific Library -- Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Scientific Library -- Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Numerical-Integration.html" title="Numerical Integration">
<link rel="prev" href="QNG-non_002dadaptive-Gauss_002dKronrod-integration.html" title="QNG non-adaptive Gauss-Kronrod integration">
<link rel="next" href="QAGS-adaptive-integration-with-singularities.html" title="QAGS adaptive integration with singularities">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 The GSL Team.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU General Public License'' and ``Free Software
Needs Free Documentation'', the Front-Cover text being ``A GNU Manual'',
and with the Back-Cover Text being (a) (see below).  A copy of the
license is included in the section entitled ``GNU Free Documentation
License''.

(a) The Back-Cover Text is: ``You have the freedom to copy and modify this
GNU Manual.''-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="QAG-adaptive-integration"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="QAGS-adaptive-integration-with-singularities.html">QAGS adaptive integration with singularities</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="QNG-non_002dadaptive-Gauss_002dKronrod-integration.html">QNG non-adaptive Gauss-Kronrod integration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Numerical-Integration.html">Numerical Integration</a>
<hr>
</div>

<h3 class="section">17.3 QAG adaptive integration</h3>

<p><a name="index-QAG-quadrature-algorithm-1529"></a>
The QAG algorithm is a simple adaptive integration procedure.  The
integration region is divided into subintervals, and on each iteration
the subinterval with the largest estimated error is bisected.  This
reduces the overall error rapidly, as the subintervals become
concentrated around local difficulties in the integrand.  These
subintervals are managed by a <code>gsl_integration_workspace</code> struct,
which handles the memory for the subinterval ranges, results and error
estimates.

<div class="defun">
&mdash; Function: gsl_integration_workspace * <b>gsl_integration_workspace_alloc</b> (<var>size_t n</var>)<var><a name="index-gsl_005fintegration_005fworkspace_005falloc-1530"></a></var><br>
<blockquote><p><a name="index-gsl_005fintegration_005fworkspace-1531"></a>This function allocates a workspace sufficient to hold <var>n</var> double
precision intervals, their integration results and error estimates. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>gsl_integration_workspace_free</b> (<var>gsl_integration_workspace * w</var>)<var><a name="index-gsl_005fintegration_005fworkspace_005ffree-1532"></a></var><br>
<blockquote><p>This function frees the memory associated with the workspace <var>w</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>gsl_integration_qag</b> (<var>const gsl_function * f, double a, double b, double epsabs, double epsrel, size_t limit, int key, gsl_integration_workspace * workspace, double * result, double * abserr</var>)<var><a name="index-gsl_005fintegration_005fqag-1533"></a></var><br>
<blockquote>
        <p>This function applies an integration rule adaptively until an estimate
of the integral of f over (a,b) is achieved within the
desired absolute and relative error limits, <var>epsabs</var> and
<var>epsrel</var>.  The function returns the final approximation,
<var>result</var>, and an estimate of the absolute error, <var>abserr</var>.  The
integration rule is determined by the value of <var>key</var>, which should
be chosen from the following symbolic names,

     <pre class="example">          GSL_INTEG_GAUSS15  (key = 1)
          GSL_INTEG_GAUSS21  (key = 2)
          GSL_INTEG_GAUSS31  (key = 3)
          GSL_INTEG_GAUSS41  (key = 4)
          GSL_INTEG_GAUSS51  (key = 5)
          GSL_INTEG_GAUSS61  (key = 6)
</pre>
        <p class="noindent">corresponding to the 15, 21, 31, 41, 51 and 61 point Gauss-Kronrod
rules.  The higher-order rules give better accuracy for smooth functions,
while lower-order rules save time when the function contains local
difficulties, such as discontinuities.

        <p>On each iteration the adaptive integration strategy bisects the interval
with the largest error estimate.  The subintervals and their results are
stored in the memory provided by <var>workspace</var>.  The maximum number of
subintervals is given by <var>limit</var>, which may not exceed the allocated
size of the workspace. 
</p></blockquote></div>

<hr>The GNU Scientific Library - a free numerical library licensed under the GNU GPL<br>Back to the <a href="/software/gsl/">GNU Scientific Library Homepage</a></body></html>

