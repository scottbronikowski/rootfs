<!?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks Publisher 2003 for FrameMaker 8.0.8.2296" />
    <meta name="TEMPLATEBASE" content="HDF4 Version 1.0" />
    <meta name="LASTUPDATED" content="07/16/09 01:40:38" />
    <title>create_annotation.c</title>
    <link rel="StyleSheet" href="document.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="catalog.css" type="text/css" media="all" />
<link rel="first" title="First" href="UGTop.html" />
<link rel="last" title="Last" href="UG_BookIX.html" />
<link rel="previous" title="Previous" href="Examples_DFSD.html" />
<link rel="next" title="Next" href="Example_Vg.html" />

    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/seealso.js"></script>

    <script type="text/javascript" language="JavaScript1.2">
     <!--
      var  WebWorksSeeAlso = new WebWorksSeeAlso_Object();
     // -->
    </script>
  </head>

  <body>

    <p>
    <table id="SummaryNotReq1" border="0" width="850"cellspacing="0" cellpadding="0">
      <tr>
        <td align="left">
          <a href="http://www.hdfgroup.org"><img id="LongDescNotReq1" border="0" src="images/hdf_logo.jpg" width="90" height="70" alt="The HDF Group" valign="top" /></a>
        </td>
        <td valign="middle" align="center">
          <b><H1>HDF User’s Guide</H1>
           Version 4.2r4</b><br />
        </td>
        <td valign="middle" align="right">
        <br/>
<b><a HREF="UGTOP.html">[Top]</a>
<a accesskey="3" href="Examples_DFSD.html"><b>[Prev]</b><a accesskey="4" href="Example_Vg.html"><b>[Next]</b></b>
        </td>
      </tr>
    </table>
    </p>
    <hr />

    <blockquote>
<a name="wp929676"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
create_annotation.c
</div>
<a name="wp929862"> </a><p style="font-family: Arial; font-size: 10pt" class="pBodyRelative">
</p>
<div align="left">
<table border="1" id="wp929865table929863">
  <caption></caption>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
<span style="color: #000000; font-family: Arial; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline" class="cDefault">#include &quot;hdf.h&quot;</span><a name="wp929865"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#define  FILE_NAME      &quot;General_HDFobjects.hdf&quot;<a name="wp929869"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#define  VG_NAME        &quot;AN Vgroup&quot;<a name="wp929871"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#define  FILE_LABEL_TXT &quot;General HDF objects&quot;<a name="wp929873"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#define  FILE_DESC_TXT  &quot;This is an HDF file that contains general HDF objects&quot;<a name="wp929875"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#define  DATA_LABEL_TXT &quot;Common AN Vgroup&quot;<a name="wp929877"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#define  DATA_DESC_TXT  &quot;This is a vgroup that is used to test data annotations&quot;<a name="wp929879"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
main( )<a name="wp929883"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
{<a name="wp929885"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /************************* Variable declaration **************************/<a name="wp929887"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   intn   status_n;     /* returned status for functions returning an intn  */<a name="wp929891"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   int32  status_32,    /* returned status for functions returning an int32 */<a name="wp929893"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          file_id,      /* HDF file identifier */<a name="wp929895"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          an_id,        /* AN interface identifier */<a name="wp929897"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          file_label_id,  /* file label identifier */<a name="wp929899"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          file_desc_id,   /* file description identifier */<a name="wp929901"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          data_label_id,  /* data label identifier */<a name="wp929903"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          data_desc_id,   /* data description identifier */<a name="wp929905"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
          vgroup_id;<a name="wp929907"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   uint16 vgroup_tag, vgroup_ref;<a name="wp929909"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /********************** End of variable declaration **********************/<a name="wp929913"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929917"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Create the HDF file.<a name="wp929919"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929921"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   file_id = Hopen (FILE_NAME, DFACC_CREATE, 0);<a name="wp929923"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929927"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Initialize the AN interface.<a name="wp929929"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929931"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   an_id = ANstart(file_id);<a name="wp929933"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929937"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Create the file label.<a name="wp929939"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929941"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   file_label_id = ANcreatef(an_id, AN_FILE_LABEL);<a name="wp929943"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929947"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Write the annotations to the file label.<a name="wp929949"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929951"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = ANwriteann(file_label_id, FILE_LABEL_TXT, <a name="wp929953"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
                          strlen (FILE_LABEL_TXT));<a name="wp929955"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929959"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Create file description.<a name="wp929961"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929963"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   file_desc_id = ANcreatef(an_id, AN_FILE_DESC);<a name="wp929965"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929969"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Write the annotation to the file description.  <a name="wp929971"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929973"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = ANwriteann(file_desc_id, FILE_DESC_TXT, <a name="wp929975"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
                          strlen (FILE_DESC_TXT));<a name="wp929977"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929981"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Create a vgroup in the V interface.  Note that the vgroup&#39;s ref number <a name="wp929983"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * is set to -1 for creating and the access mode is &quot;w&quot; for writing.<a name="wp929985"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp929987"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = Vstart(file_id);<a name="wp929989"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   vgroup_id = Vattach(file_id, -1, &quot;w&quot;);<a name="wp929991"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = Vsetname (vgroup_id, VG_NAME);<a name="wp929993"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp929997"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Obtain the tag and ref number of the vgroup for subsequent<a name="wp929999"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * references.  <a name="wp930001"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930003"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   vgroup_tag = (uint16) VQuerytag (vgroup_id);<a name="wp930005"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   vgroup_ref = (uint16) VQueryref (vgroup_id);<a name="wp930007"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930011"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Create the data label for the vgroup identified by its tag <a name="wp930013"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * and ref number.<a name="wp930015"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930017"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   data_label_id = ANcreate(an_id, vgroup_tag, vgroup_ref, AN_DATA_LABEL);<a name="wp930019"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930023"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Write the annotation text to the data label.<a name="wp930025"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930027"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = ANwriteann(data_label_id, DATA_LABEL_TXT, <a name="wp930029"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
                          strlen(DATA_LABEL_TXT));<a name="wp930031"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930035"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Create the data description for the vgroup identified by its tag <a name="wp930037"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * and ref number.<a name="wp930039"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930041"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   data_desc_id = ANcreate(an_id, vgroup_tag, vgroup_ref, AN_DATA_DESC);<a name="wp930043"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930047"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Write the annotation text to the data description.<a name="wp930049"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930051"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = ANwriteann(data_desc_id, DATA_DESC_TXT, strlen(DATA_DESC_TXT));<a name="wp930053"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930057"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Teminate access to the vgroup and to the V interface.<a name="wp930059"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930061"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = Vdetach(vgroup_id);<a name="wp930063"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = Vend(file_id);<a name="wp930065"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930069"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Terminate access to each annotation explicitly.<a name="wp930071"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930073"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = ANendaccess(file_label_id);<a name="wp930075"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = ANendaccess(file_desc_id);<a name="wp930077"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = ANendaccess(data_label_id);<a name="wp930079"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = ANendaccess(data_desc_id);<a name="wp930081"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td>&#160;</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   /*<a name="wp930085"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   * Terminate access to the AN interface and close the HDF file.<a name="wp930087"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   */<a name="wp930089"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_32 = ANend(an_id);<a name="wp930091"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
   status_n = Hclose(file_id);<a name="wp930093"> </a>
</pre></div>
</td>
</tr>
  <tr align="left">    <td><div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
}<a name="wp930095"> </a>
</pre></div>
</td>
</tr>
</table>
</div>
<p style="font-family: Arial; font-size: 10pt" class="pBodyRelative">


</p>
<a name="wp929641"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
create_annotation.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program create_annotation<a name="wp928861"> </a>
      implicit none<a name="wp928866"> </a>
C<a name="wp928867"> </a>
C     Parameter declaration<a name="wp928868"> </a>
C<a name="wp928869"> </a>
      character*22 FILE_NAME<a name="wp928870"> </a>
      character*9  VG_NAME<a name="wp928871"> </a>
      character*19 FILE_LABEL_TXT<a name="wp928872"> </a>
      character*53 FILE_DESC_TXT<a name="wp928873"> </a>
      character*16 DATA_LABEL_TXT<a name="wp928874"> </a>
      character*54 DATA_DESC_TXT<a name="wp928875"> </a>
C<a name="wp928876"> </a>
      parameter (FILE_NAME      = &#39;General_HDFobjects.hdf&#39;,<a name="wp928877"> </a>
     +           VG_NAME        = &#39;AN Vgroup&#39;,<a name="wp928878"> </a>
     +           FILE_LABEL_TXT = &#39;General HDF objects&#39;,<a name="wp928879"> </a>
     +           DATA_LABEL_TXT = &#39;Common AN Vgroup&#39;,<a name="wp928880"> </a>
     +           FILE_DESC_TXT  = <a name="wp928881"> </a>
     + &#39;This is an HDF file that contains general HDF objects&#39;,<a name="wp928882"> </a>
     +           DATA_DESC_TXT  = <a name="wp928883"> </a>
     + &#39;This is a vgroup that is used to test data annotations&#39;)<a name="wp928884"> </a>
      integer DFACC_CREATE<a name="wp928885"> </a>
      parameter (DFACC_CREATE = 4)<a name="wp928886"> </a>
      integer AN_FILE_LABEL, AN_FILE_DESC, AN_DATA_LABEL, AN_DATA_DESC<a name="wp928887"> </a>
      parameter (AN_FILE_LABEL = 2,<a name="wp928888"> </a>
     +           AN_FILE_DESC  = 3,<a name="wp928889"> </a>
     +           AN_DATA_LABEL = 0,<a name="wp928890"> </a>
     +           AN_DATA_DESC  = 1)<a name="wp928891"> </a>
C<a name="wp928892"> </a>
C     Function declaration<a name="wp928893"> </a>
C<a name="wp928894"> </a>
      integer hopen, hclose<a name="wp928895"> </a>
      integer afstart, affcreate, afwriteann, afcreate,<a name="wp928896"> </a>
     +        afendaccess, afend<a name="wp928897"> </a>
      integer vfstart, vfatch, vfsnam, vqref, vqtag, vfdtch, vfend<a name="wp928898"> </a>
C<a name="wp928900"> </a>
C**** Variable declaration ******************************************* <a name="wp928901"> </a>
C<a name="wp928902"> </a>
      integer status<a name="wp928903"> </a>
      integer file_id, an_id<a name="wp928904"> </a>
      integer file_label_id, file_desc_id<a name="wp928905"> </a>
      integer data_label_id, data_desc_id<a name="wp928906"> </a>
      integer vgroup_id, vgroup_tag, vgroup_ref<a name="wp928907"> </a>
C<a name="wp928908"> </a>
C**** End of variable declaration ************************************<a name="wp928909"> </a>
C<a name="wp928910"> </a>
C<a name="wp928911"> </a>
C     Create the HDF file.<a name="wp928912"> </a>
C<a name="wp928913"> </a>
      file_id = hopen(FILE_NAME, DFACC_CREATE, 0)<a name="wp928914"> </a>
C<a name="wp928915"> </a>
C     Initialize the AN interface.<a name="wp928916"> </a>
C<a name="wp928917"> </a>
      an_id = afstart(file_id)<a name="wp928918"> </a>
C<a name="wp928919"> </a>
C     Create the file label.<a name="wp928920"> </a>
C<a name="wp928921"> </a>
      file_label_id = affcreate(an_id, AN_FILE_LABEL)<a name="wp928922"> </a>
C<a name="wp928923"> </a>
C     Write the annotation to the file label.<a name="wp928924"> </a>
C<a name="wp928925"> </a>
      status = afwriteann(file_label_id, FILE_LABEL_TXT,<a name="wp928926"> </a>
     +                    len(FILE_LABEL_TXT))       <a name="wp928927"> </a>
C<a name="wp928928"> </a>
C     Create file description.<a name="wp928929"> </a>
C<a name="wp928930"> </a>
      file_desc_id = affcreate(an_id, AN_FILE_DESC)<a name="wp928931"> </a>
C<a name="wp928932"> </a>
C     Write the annotation to the file description.<a name="wp928933"> </a>
C<a name="wp928934"> </a>
      status = afwriteann(file_desc_id, FILE_DESC_TXT,<a name="wp928935"> </a>
     +                    len(FILE_DESC_TXT))<a name="wp928936"> </a>
C<a name="wp928937"> </a>
C     Create a vgroup in the file. Note that the vgroup&#39;s ref number is<a name="wp928938"> </a>
C     set to -1 for creating and the access mode is &#39;w&#39; for writing.<a name="wp928939"> </a>
C<a name="wp928940"> </a>
      status    = vfstart(file_id)<a name="wp928941"> </a>
      vgroup_id = vfatch(file_id, -1, &#39;w&#39;)<a name="wp928942"> </a>
      status    = vfsnam(vgroup_id, VG_NAME)      <a name="wp928943"> </a>
C<a name="wp928944"> </a>
C     Obtain the tag and reference number of the vgroup for subsequent<a name="wp928945"> </a>
C     references.<a name="wp928946"> </a>
C<a name="wp928947"> </a>
      vgroup_ref = vqref(vgroup_id)<a name="wp928948"> </a>
      vgroup_tag = vqtag(vgroup_id)<a name="wp928949"> </a>
C<a name="wp928950"> </a>
C     Create the data label for the vgroup identified by its tag and ref <a name="wp928951"> </a>
C     number.<a name="wp928952"> </a>
C<a name="wp928953"> </a>
      data_label_id = afcreate(an_id, vgroup_tag, vgroup_ref,<a name="wp928954"> </a>
     +                          AN_DATA_LABEL)<a name="wp928955"> </a>
C<a name="wp928956"> </a>
C     Write the annotation text to the data label.<a name="wp928957"> </a>
C<a name="wp928958"> </a>
      status = afwriteann(data_label_id, DATA_LABEL_TXT, <a name="wp928959"> </a>
     +                    len(DATA_LABEL_TXT))<a name="wp928960"> </a>
      <a name="wp928961"> </a>
C<a name="wp928962"> </a>
C     Create the data description for the vgroup identified by its tag and ref.<a name="wp928963"> </a>
C<a name="wp928964"> </a>
      data_desc_id = afcreate(an_id, vgroup_tag, vgroup_ref, <a name="wp928965"> </a>
     +                        AN_DATA_DESC)<a name="wp928966"> </a>
C<a name="wp928967"> </a>
C     Write the annotation text to the data description.<a name="wp928968"> </a>
C<a name="wp928969"> </a>
      status = afwriteann(data_desc_id, DATA_DESC_TXT,<a name="wp928970"> </a>
     +                    len(DATA_DESC_TXT))       <a name="wp928971"> </a>
C      <a name="wp928972"> </a>
C     Terminate access to the vgroup and to the V interface.<a name="wp928973"> </a>
C<a name="wp928974"> </a>
      status = vfdtch(vgroup_id)<a name="wp928975"> </a>
      status = vfend(file_id)<a name="wp928976"> </a>
C<a name="wp928977"> </a>
C     Terminate access to each annotation explicitly.<a name="wp928978"> </a>
C<a name="wp928979"> </a>
      status = afendaccess(file_label_id)<a name="wp928980"> </a>
      status = afendaccess(file_desc_id)<a name="wp928981"> </a>
      status = afendaccess(data_label_id)<a name="wp928982"> </a>
      status = afendaccess(data_desc_id)<a name="wp928983"> </a>
C<a name="wp928984"> </a>
C     Terminate access to the AN interface and close the HDF file.<a name="wp928985"> </a>
C<a name="wp928986"> </a>
      status = afend(an_id)<a name="wp928987"> </a>
      status = hclose(file_id)<a name="wp928988"> </a>
      end <a name="wp928989"> </a>
</pre></div>
<a name="wp929010"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
read_annotation.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp929014"> </a>
#define  FILE_NAME   &quot;General_HDFobjects.hdf&quot;<a name="wp929020"> </a>
main( )<a name="wp929022"> </a>
{<a name="wp929023"> </a>
   /************************* Variable declaration **************************/<a name="wp929024"> </a>
   intn  status_n;      /* returned status for functions returning an intn  */<a name="wp929026"> </a>
   int32 status_32,     /* returned status for functions returning an int32 */<a name="wp929027"> </a>
         file_id,       /* HDF file identifier */<a name="wp929028"> </a>
         an_id,         /* AN interface identifier */<a name="wp929029"> </a>
         ann_id,        /* an annotation identifier */<a name="wp929030"> </a>
         index,         /* position of an annotation in all of the same type*/<a name="wp929031"> </a>
         ann_length,    /* length of the text in an annotation */<a name="wp929032"> </a>
         n_file_labels, n_file_descs, n_data_labels, n_data_descs;<a name="wp929033"> </a>
   char *ann_buf;       /* buffer to hold the read annotation */<a name="wp929034"> </a>
   /********************** End of variable declaration **********************/<a name="wp929036"> </a>
   /*<a name="wp929038"> </a>
   * Open the HDF file.<a name="wp929039"> </a>
   */<a name="wp929040"> </a>
   file_id = Hopen (FILE_NAME, DFACC_READ, 0);<a name="wp929041"> </a>
   /*<a name="wp929043"> </a>
   * Initialize the AN interface.<a name="wp929044"> </a>
   */<a name="wp929045"> </a>
   an_id = ANstart (file_id);<a name="wp929046"> </a>
   /*<a name="wp929048"> </a>
   * Get the annotation information, e.g., the numbers of file labels, file<a name="wp929049"> </a>
   * descriptions, data labels, and data descriptions.<a name="wp929050"> </a>
   */<a name="wp929051"> </a>
   status_n = ANfileinfo (an_id, &amp;n_file_labels, &amp;n_file_descs,<a name="wp929052"> </a>
                        &amp;n_data_labels, &amp;n_data_descs);<a name="wp929053"> </a>
   /*<a name="wp929055"> </a>
   * Get the data labels.  Note that this for loop can be used to<a name="wp929056"> </a>
   * obtain the contents of each kind of annotation with the appropriate<a name="wp929057"> </a>
   * number of annotations and the type of annotation, i.e., replace<a name="wp929058"> </a>
   * n_data_labels with n_file_labels, n_file_descs, or n_data_descs, and<a name="wp929059"> </a>
   * AN_DATA_LABEL with AN_FILE_LABEL, AN_FILE_DESC, or AN_DATA_DESC,<a name="wp929060"> </a>
   * respectively.<a name="wp929061"> </a>
   */<a name="wp929062"> </a>
   for (index = 0; index &lt; n_data_labels; index++)<a name="wp929063"> </a>
   {<a name="wp929064"> </a>
      /*<a name="wp929065"> </a>
      * Get the identifier of the current data label.<a name="wp929066"> </a>
      */<a name="wp929067"> </a>
      ann_id = ANselect (an_id, index, AN_DATA_LABEL);<a name="wp929068"> </a>
      /*<a name="wp929070"> </a>
      * Get the length of the data label.<a name="wp929071"> </a>
      */<a name="wp929072"> </a>
      ann_length = ANannlen (ann_id);<a name="wp929073"> </a>
      /*<a name="wp929075"> </a>
      * Allocate space for the buffer to hold the data label text.<a name="wp929076"> </a>
      */<a name="wp929077"> </a>
      ann_buf = malloc ((ann_length+1) * sizeof (char));<a name="wp929078"> </a>
      /*<a name="wp929080"> </a>
      * Read and display the data label.  Note that the size of the buffer,<a name="wp929081"> </a>
      * i.e., the third parameter, is 1 character more than the length of<a name="wp929082"> </a>
      * the data label; that is for the null character.  It is not the case<a name="wp929083"> </a>
      * when a description is retrieved because the description does not <a name="wp929084"> </a>
      * necessarily end with a null character.<a name="wp929085"> </a>
      * <a name="wp929086"> </a>
      */<a name="wp929087"> </a>
      status_32 = ANreadann (ann_id, ann_buf, ann_length+1);<a name="wp929088"> </a>
      printf (&quot;Data label index: %d\n&quot;, index);<a name="wp929089"> </a>
      printf (&quot;Data label contents: %s\n&quot;, ann_buf);<a name="wp929090"> </a>
      /*<a name="wp929092"> </a>
      * Terminate access to the current data label.<a name="wp929093"> </a>
      */<a name="wp929094"> </a>
      status_n = ANendaccess (ann_id);<a name="wp929095"> </a>
      /*<a name="wp929097"> </a>
      * Free the space allocated for the annotation buffer.<a name="wp929098"> </a>
      */<a name="wp929099"> </a>
      free (ann_buf);<a name="wp929100"> </a>
   }<a name="wp929101"> </a>
   /*<a name="wp929103"> </a>
   * Terminate access to the AN interface and close the HDF file.<a name="wp929104"> </a>
   */<a name="wp929105"> </a>
   status_32 = ANend (an_id);<a name="wp929106"> </a>
   status_n = Hclose (file_id);<a name="wp929107"> </a>
}<a name="wp929108"> </a>
</pre></div>
<a name="wp929118"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
read_annotation.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program  read_annotation<a name="wp929119"> </a>
      implicit none<a name="wp929124"> </a>
C<a name="wp929125"> </a>
C     Parameter declaration<a name="wp929126"> </a>
C<a name="wp929127"> </a>
      character*22 FILE_NAME<a name="wp929128"> </a>
C<a name="wp929129"> </a>
      parameter (FILE_NAME = &#39;General_HDFobjects.hdf&#39;)<a name="wp929130"> </a>
      integer    DFACC_READ<a name="wp929131"> </a>
      parameter (DFACC_READ = 1)<a name="wp929132"> </a>
      integer    AN_DATA_LABEL<a name="wp929133"> </a>
      parameter (AN_DATA_LABEL = 0)<a name="wp929134"> </a>
C<a name="wp929135"> </a>
C     Function declaration<a name="wp929136"> </a>
C<a name="wp929137"> </a>
      integer hopen, hclose<a name="wp929138"> </a>
      integer afstart, affileinfo, afselect, afannlen, afreadann,<a name="wp929139"> </a>
     +        afendaccess, afend<a name="wp929140"> </a>
C<a name="wp929141"> </a>
C**** Variable declaration *******************************************<a name="wp929142"> </a>
C<a name="wp929143"> </a>
      integer status<a name="wp929144"> </a>
      integer file_id, an_id, ann_id<a name="wp929145"> </a>
      integer index, ann_length <a name="wp929146"> </a>
      integer n_file_labels, n_file_descs, n_data_labels, n_data_descs <a name="wp929147"> </a>
      character*256 ann_buf <a name="wp929148"> </a>
C<a name="wp929149"> </a>
C**** End of variable declaration ************************************<a name="wp929150"> </a>
C<a name="wp929151"> </a>
C<a name="wp929152"> </a>
C     Open the HDF file for reading.<a name="wp929153"> </a>
C<a name="wp929154"> </a>
      file_id = hopen(FILE_NAME, DFACC_READ, 0)<a name="wp929155"> </a>
C<a name="wp929156"> </a>
C     Initialize the AN interface.<a name="wp929157"> </a>
C<a name="wp929158"> </a>
      an_id = afstart(file_id)<a name="wp929159"> </a>
C<a name="wp929160"> </a>
C     Get the annotation information, i.e., the number of file labels,<a name="wp929161"> </a>
C     file descriptions, data labels, and data descriptions.<a name="wp929162"> </a>
C<a name="wp929163"> </a>
      status = affileinfo(an_id, n_file_labels, n_file_descs,<a name="wp929164"> </a>
     +                    n_data_labels, n_data_descs)<a name="wp929165"> </a>
C<a name="wp929166"> </a>
C     Get the data labels. Note that this DO loop can be used to obtain <a name="wp929167"> </a>
C     the contents of each kind of annotation with the appropriate number<a name="wp929168"> </a>
C     of annotations and the type of annotation, i.e., replace<a name="wp929169"> </a>
C     n_data_labels with n_file_labels, n_files_descs, or n_data_descs, and<a name="wp929170"> </a>
C     AN_DATA_LABEL with AN_FILE_LABEL, AN_FILE_DESC, or AN_DATA_DESC, <a name="wp929171"> </a>
C     respectively.<a name="wp929172"> </a>
C<a name="wp929173"> </a>
      do 10 index = 0, n_data_labels-1<a name="wp929174"> </a>
C<a name="wp929175"> </a>
C     Get the identifier of the current data label.<a name="wp929176"> </a>
C<a name="wp929177"> </a>
      ann_id = afselect(an_id, index, AN_DATA_LABEL)<a name="wp929178"> </a>
C<a name="wp929179"> </a>
C     Get the length of the data label.<a name="wp929180"> </a>
C<a name="wp929181"> </a>
      ann_length = afannlen(ann_id)<a name="wp929182"> </a>
C<a name="wp929183"> </a>
C     Read and display the data label. The data label is read into buffer<a name="wp929184"> </a>
C     ann_buf. One has to make sure that ann_buf has sufficient size to hold<a name="wp929185"> </a>
C     the data label. Also note, that the third argument to afreadann is <a name="wp929186"> </a>
C     1 greater that the actual length of the data label (see comment to<a name="wp929187"> </a>
C     C example).<a name="wp929188"> </a>
C<a name="wp929189"> </a>
      status = afreadann(ann_id, ann_buf, ann_length+1) <a name="wp929190"> </a>
      write(*,*) &#39;Data label index: &#39;, index<a name="wp929191"> </a>
      write(*,*) &#39;Data label contents: &#39;, ann_buf(1:ann_length) <a name="wp929192"> </a>
10    continue<a name="wp929193"> </a>
C<a name="wp929194"> </a>
C     Terminate access to the current data label.<a name="wp929195"> </a>
C<a name="wp929196"> </a>
      status = afendaccess(ann_id)  <a name="wp929197"> </a>
C<a name="wp929198"> </a>
C     Terminate access to the AN interface and close the HDF file.<a name="wp929199"> </a>
C<a name="wp929200"> </a>
      status = afend(an_id)<a name="wp929201"> </a>
      status = hclose(file_id)<a name="wp929202"> </a>
      end<a name="wp929203"> </a>
</pre></div>
<a name="wp929634"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
get_annotation_info.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp929364"> </a>
#define  FILE_NAME   &quot;General_HDFobjects.hdf&quot;<a name="wp929366"> </a>
#define  VG_NAME     &quot;AN Vgroup&quot;<a name="wp929367"> </a>
main( )<a name="wp929369"> </a>
{<a name="wp929370"> </a>
   /************************* Variable declaration **************************/<a name="wp929371"> </a>
   intn   status_n;      /* returned status for functions returning an intn */<a name="wp929373"> </a>
   int32  status_32,     /* returned status for functions returning an int32*/<a name="wp929374"> </a>
          file_id, an_id, ann_id, <a name="wp929375"> </a>
          n_annots,      /* number of annotations */<a name="wp929376"> </a>
         *ann_list,      /* list of annotation identifiers */<a name="wp929377"> </a>
          vgroup_ref,    /* reference number of the vgroup */<a name="wp929378"> </a>
          index;         /* index of an annotation in the annotation list */<a name="wp929379"> </a>
          ann_type annot_type = AN_DATA_DESC;   /* annotation to be obtained*/<a name="wp929380"> </a>
   uint16 ann_tag, ann_ref,              /* tag/ref number of an annotation */<a name="wp929381"> </a>
          vgroup_tag = DFTAG_VG;         /* tag of the vgroup */<a name="wp929382"> </a>
   /********************** End of variable declaration **********************/<a name="wp929384"> </a>
   /*<a name="wp929386"> </a>
   * Create the HDF file.<a name="wp929387"> </a>
   */<a name="wp929388"> </a>
   file_id = Hopen (FILE_NAME, DFACC_READ, 0);<a name="wp929389"> </a>
   /*<a name="wp929391"> </a>
   * Initialize the V interface.<a name="wp929392"> </a>
   */<a name="wp929393"> </a>
   status_n = Vstart (file_id);<a name="wp929394"> </a>
   /*<a name="wp929396"> </a>
   * Get the vgroup named VG_NAME.<a name="wp929397"> </a>
   */<a name="wp929398"> </a>
   vgroup_ref = Vfind  (file_id, VG_NAME);<a name="wp929399"> </a>
   /*<a name="wp929401"> </a>
   * Initialize the AN interface and obtain an interface id.<a name="wp929402"> </a>
   */<a name="wp929403"> </a>
   an_id = ANstart (file_id);<a name="wp929404"> </a>
   /*<a name="wp929406"> </a>
   * Get the number of object descriptions.  Note that, since ANnumann takes<a name="wp929407"> </a>
   * the tag and reference number as being of type unit16, vgroup_ref must be<a name="wp929408"> </a>
   * safely cast to uint16 by checking for FAIL value first.<a name="wp929409"> </a>
   */<a name="wp929410"> </a>
   if (vgroup_ref != FAIL)<a name="wp929411"> </a>
   {<a name="wp929412"> </a>
      n_annots = ANnumann (an_id, annot_type, vgroup_tag, (uint16)vgroup_ref);<a name="wp929413"> </a>
      /*<a name="wp929415"> </a>
      * Allocate space to hold the annotation identifiers.<a name="wp929416"> </a>
      */<a name="wp929417"> </a>
      ann_list = malloc (n_annots * sizeof (int32));<a name="wp929418"> </a>
      /*<a name="wp929420"> </a>
      * Get the list of identifiers of the annotations attached to the <a name="wp929421"> </a>
      * vgroup and of type annot_type.<a name="wp929422"> </a>
      */<a name="wp929423"> </a>
      n_annots = ANannlist (an_id, annot_type, vgroup_tag, (uint16)vgroup_ref, <a name="wp929424"> </a>
                            ann_list);<a name="wp929425"> </a>
      /*<a name="wp929427"> </a>
      * Get each annotation identifier from the list then display the <a name="wp929428"> </a>
      * tag/ref number pair of the corresponding annotation.<a name="wp929429"> </a>
      */<a name="wp929430"> </a>
      printf (&quot;List of annotations of type AN_DATA_DESC:\n&quot;);<a name="wp929431"> </a>
      for (index = 0; index &lt; n_annots; index++)<a name="wp929432"> </a>
      {<a name="wp929433"> </a>
        /*<a name="wp929434"> </a>
         * Get and display the ref number of the annotation from <a name="wp929435"> </a>
         * its identifier.<a name="wp929436"> </a>
         */<a name="wp929437"> </a>
         status_32 = ANid2tagref (ann_list[index], &amp;ann_tag, &amp;ann_ref);<a name="wp929438"> </a>
         printf (&quot;Annotation index %d: tag = %s\nreference number= %d\n&quot;, <a name="wp929439"> </a>
           index, ann_tag == DFTAG_DIA ? &quot;DFTAG_DIA (data description)&quot;:<a name="wp929440"> </a>
           &quot;Incorrect&quot;, ann_ref);<a name="wp929441"> </a>
      } /* for */<a name="wp929442"> </a>
   } /* for */<a name="wp929443"> </a>
   /*<a name="wp929445"> </a>
   * Get and display an annotation type from an annotation tag.<a name="wp929446"> </a>
   */<a name="wp929447"> </a>
   annot_type = ANtag2atype (DFTAG_FID);<a name="wp929448"> </a>
   printf (&quot;\nAnnotation type of DFTAG_FID (file label) is %s\n&quot;, <a name="wp929449"> </a>
              annot_type == AN_FILE_LABEL ? &quot;AN_FILE_LABEL&quot;:&quot;Incorrect&quot;);<a name="wp929450"> </a>
   /*<a name="wp929452"> </a>
   * Get and display an annotation tag from an annotation type.<a name="wp929453"> </a>
   */<a name="wp929454"> </a>
   ann_tag = ANatype2tag (AN_DATA_LABEL);<a name="wp929455"> </a>
   printf (&quot;\nAnnotation tag of AN_DATA_LABEL is %s\n&quot;, <a name="wp929456"> </a>
              ann_tag == DFTAG_DIL ? &quot;DFTAG_DIL (data label)&quot;:&quot;Incorrect&quot;);<a name="wp929457"> </a>
   /*<a name="wp929459"> </a>
   * Terminate access to the AN interface and close the HDF file.<a name="wp929460"> </a>
   */<a name="wp929461"> </a>
   status_32 = ANend (an_id);<a name="wp929462"> </a>
   status_n = Hclose (file_id);<a name="wp929463"> </a>
   /*<a name="wp929465"> </a>
   * Free the space allocated for the annotation identifier list.<a name="wp929466"> </a>
   */<a name="wp929467"> </a>
   free (ann_list);<a name="wp929468"> </a>
}<a name="wp929469"> </a>
</pre></div>
<a name="wp929635"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
get_annotation_info.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program annotation_info<a name="wp929478"> </a>
      implicit none<a name="wp929483"> </a>
C<a name="wp929484"> </a>
C     Parameter declaration<a name="wp929485"> </a>
C<a name="wp929486"> </a>
      character*22 FILE_NAME<a name="wp929487"> </a>
      character*9  VG_NAME<a name="wp929488"> </a>
C<a name="wp929489"> </a>
      parameter (FILE_NAME      = &#39;General_HDFobjects.hdf&#39;,<a name="wp929490"> </a>
     +           VG_NAME        = &#39;AN Vgroup&#39;)<a name="wp929491"> </a>
      integer    DFACC_READ<a name="wp929492"> </a>
      parameter (DFACC_READ = 1)<a name="wp929493"> </a>
      integer AN_FILE_LABEL, AN_DATA_LABEL, AN_DATA_DESC<a name="wp929494"> </a>
      parameter (AN_FILE_LABEL = 2,<a name="wp929495"> </a>
     +           AN_DATA_LABEL = 0,<a name="wp929496"> </a>
     +           AN_DATA_DESC  = 1)<a name="wp929497"> </a>
      integer DFTAG_DIA, DFTAG_FID, DFTAG_DIL<a name="wp929498"> </a>
      parameter (DFTAG_DIA = 105,<a name="wp929499"> </a>
     +           DFTAG_FID = 100,<a name="wp929500"> </a>
     +           DFTAG_DIL = 104)<a name="wp929501"> </a>
      integer DFTAG_VG<a name="wp929502"> </a>
      parameter (DFTAG_VG = 1965)<a name="wp929503"> </a>
C<a name="wp929504"> </a>
C     Function declaration<a name="wp929505"> </a>
C<a name="wp929506"> </a>
      integer hopen, hclose<a name="wp929507"> </a>
      integer afstart, afnumann, afannlist, afidtagref, aftagatype,<a name="wp929508"> </a>
     +        afatypetag, afend<a name="wp929509"> </a>
      integer vfstart, vfind <a name="wp929510"> </a>
C<a name="wp929512"> </a>
C**** Variable declaration *******************************************<a name="wp929513"> </a>
C<a name="wp929514"> </a>
      integer status<a name="wp929515"> </a>
      integer file_id, an_id<a name="wp929516"> </a>
      integer n_annots, ann_index, annot_type, ann_tag, ann_ref<a name="wp929517"> </a>
      integer ann_list(10) <a name="wp929518"> </a>
      integer vgroup_tag, vgroup_ref<a name="wp929519"> </a>
C<a name="wp929520"> </a>
C**** End of variable declaration ************************************<a name="wp929521"> </a>
C<a name="wp929522"> </a>
      annot_type = AN_DATA_DESC<a name="wp929523"> </a>
      vgroup_tag = DFTAG_VG<a name="wp929524"> </a>
C<a name="wp929525"> </a>
C     Open the HDF file for reading.<a name="wp929526"> </a>
C<a name="wp929527"> </a>
      file_id = hopen(FILE_NAME, DFACC_READ, 0)<a name="wp929528"> </a>
C<a name="wp929529"> </a>
C     Initialize the V interface.<a name="wp929530"> </a>
C<a name="wp929531"> </a>
      status = vfstart(file_id)<a name="wp929532"> </a>
C<a name="wp929533"> </a>
C     Get the group named VG_NAME.<a name="wp929534"> </a>
C<a name="wp929535"> </a>
      vgroup_ref = vfind(file_id, VG_NAME)<a name="wp929536"> </a>
C<a name="wp929537"> </a>
C     Initialize the AN interface.<a name="wp929538"> </a>
C<a name="wp929539"> </a>
      an_id = afstart(file_id)<a name="wp929540"> </a>
C<a name="wp929542"> </a>
C     Get the number of object descriptions. <a name="wp929543"> </a>
C<a name="wp929544"> </a>
      if (vgroup_ref .eq. -1) goto 100 <a name="wp929545"> </a>
      n_annots = afnumann(an_id, annot_type, vgroup_tag, vgroup_ref)<a name="wp929546"> </a>
C<a name="wp929547"> </a>
C     Get the list of identifiers of the annotations attached to the<a name="wp929548"> </a>
C     vgroup and of type annot_type. Identifiers are read into ann_list<a name="wp929549"> </a>
C     buffer. One has to make sure that ann_list has the size big enough<a name="wp929550"> </a>
C     to hold the list of identifiers.<a name="wp929551"> </a>
C<a name="wp929552"> </a>
      n_annots = afannlist(an_id, annot_type, vgroup_tag, vgroup_ref,<a name="wp929553"> </a>
     +                     ann_list)<a name="wp929554"> </a>
C<a name="wp929555"> </a>
C     Get each annotation identifier from the list then display the<a name="wp929556"> </a>
C     tag/ref number pair of the corresponding annotation.<a name="wp929557"> </a>
C<a name="wp929558"> </a>
      write(*,*) &#39;List of annotations of type AN_DATA_DESC&#39;<a name="wp929559"> </a>
      do 10 ann_index = 0, n_annots - 1<a name="wp929560"> </a>
C<a name="wp929561"> </a>
C     Get and display the ref number of the annotation from its<a name="wp929562"> </a>
C     identifier.<a name="wp929563"> </a>
C<a name="wp929564"> </a>
      status = afidtagref(ann_list(ann_index+1), ann_tag, ann_ref) <a name="wp929565"> </a>
      write(*,*) &#39;Annotation index: &#39;, ann_index<a name="wp929566"> </a>
      if (ann_tag .eq. DFTAG_DIA) then<a name="wp929567"> </a>
          write(*,*) &#39;tag = DFTAG_DIA (data description)&#39;<a name="wp929568"> </a>
      else<a name="wp929569"> </a>
          write(*,*) &#39; tag = Incorrect&#39;<a name="wp929570"> </a>
      endif<a name="wp929571"> </a>
      write(*,*) &#39;reference number = &#39;, ann_ref<a name="wp929572"> </a>
10    continue<a name="wp929573"> </a>
C<a name="wp929574"> </a>
C     Get and display an annotation type from an annotation tag.<a name="wp929575"> </a>
C<a name="wp929576"> </a>
      annot_type = aftagatype(DFTAG_FID)<a name="wp929577"> </a>
      if (annot_type .eq. AN_FILE_LABEL) then<a name="wp929578"> </a>
         write(*,*) &#39;Annotation type of DFTAG_FID (file label) is &#39;,<a name="wp929579"> </a>
     +               &#39;AN_FILE_LABEL &#39;<a name="wp929580"> </a>
      else<a name="wp929581"> </a>
         write(*,*) &#39;Annotation type of DFTAG_FID (file label) is &#39;,<a name="wp929582"> </a>
     +               &#39;Incorrect&#39;<a name="wp929583"> </a>
      endif   <a name="wp929584"> </a>
C<a name="wp929585"> </a>
C     Get and display an annotation tag from an annotation type.<a name="wp929586"> </a>
C<a name="wp929587"> </a>
      ann_tag = afatypetag(AN_DATA_LABEL)<a name="wp929588"> </a>
      if (ann_tag .eq. DFTAG_DIL ) then<a name="wp929589"> </a>
         write(*,*) &#39;Annotation tag of AN_DATA_LABEL is &#39;,<a name="wp929590"> </a>
     +               &#39;DFTAG_DIL (data label)&#39;<a name="wp929591"> </a>
      else<a name="wp929592"> </a>
         write(*,*) &#39;Annotation type of DFTAG_FID (file label) is &#39;,<a name="wp929593"> </a>
     +               &#39;Incorrect&#39;<a name="wp929594"> </a>
      endif   <a name="wp929595"> </a>
C<a name="wp929596"> </a>
C     Terminate access to the AN interface and close the HDF file.<a name="wp929597"> </a>
C<a name="wp929598"> </a>
100   continue<a name="wp929599"> </a>
      status = afend(an_id)<a name="wp929600"> </a>
      status = hclose(file_id)<a name="wp929601"> </a>
      end<a name="wp929602"> </a>
</pre></div>
    </blockquote>

    <hr />

    <table id="SummaryNotReq2" border="0" width="850" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left">
        HDF4.2r4 - February 2009<br/>
        <a href="UG_Copyright.html">Copyright</a>
        <td align="right">
          <span style="font-size: 12px; font-weight: bold">
            The HDF Group<br />
          </span>
          <span style="font-size: 12px">
            <a href="http://www.hdfgroup.org">www.hdfgroup.org</a><br />
            <img valign="bottom" border="0" src="images/help.jpg" height="12" alt="The HDF Group" valign="top" />
          </span>
        </td>
      </tr>
    </table>

    <table id="SummaryNotReq3" width="220" border="0" cellpadding="0" cellspacing="0">
    </table>
  </body>
</html>
