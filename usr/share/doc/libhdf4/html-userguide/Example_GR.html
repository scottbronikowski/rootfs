<!?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks Publisher 2003 for FrameMaker 8.0.8.2296" />
    <meta name="TEMPLATEBASE" content="HDF4 Version 1.0" />
    <meta name="LASTUPDATED" content="07/16/09 01:40:45" />
    <title>create_and_write_image.c</title>
    <link rel="StyleSheet" href="document.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="catalog.css" type="text/css" media="all" />
<link rel="first" title="First" href="UGTop.html" />
<link rel="last" title="Last" href="UG_BookIX.html" />
<link rel="previous" title="Previous" href="Example_PAL.html" />
<link rel="next" title="Next" href="Example_DFAN.html" />

    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/seealso.js"></script>

    <script type="text/javascript" language="JavaScript1.2">
     <!--
      var  WebWorksSeeAlso = new WebWorksSeeAlso_Object();
     // -->
    </script>
  </head>

  <body>

    <p>
    <table id="SummaryNotReq1" border="0" width="850"cellspacing="0" cellpadding="0">
      <tr>
        <td align="left">
          <a href="http://www.hdfgroup.org"><img id="LongDescNotReq1" border="0" src="images/hdf_logo.jpg" width="90" height="70" alt="The HDF Group" valign="top" /></a>
        </td>
        <td valign="middle" align="center">
          <b><H1>HDF User’s Guide</H1>
           Version 4.2r4</b><br />
        </td>
        <td valign="middle" align="right">
        <br/>
<b><a HREF="UGTOP.html">[Top]</a>
<a accesskey="3" href="Example_PAL.html"><b>[Prev]</b><a accesskey="4" href="Example_DFAN.html"><b>[Next]</b></b>
        </td>
      </tr>
    </table>
    </p>
    <hr />

    <blockquote>
<a name="wp928550"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
create_and_write_image.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp928554"> </a>
#define  FILE_NAME     &quot;General_RImages.hdf&quot;<a name="wp928600"> </a>
#define  IMAGE_NAME    &quot;Image Array 1&quot;<a name="wp928601"> </a>
#define  X_LENGTH      10    /* number of columns in the image */<a name="wp928602"> </a>
#define  Y_LENGTH      5     /* number of rows in the image */<a name="wp928603"> </a>
#define  N_COMPS       2     /* number of components in the image */<a name="wp928604"> </a>
main( ) <a name="wp928606"> </a>
{<a name="wp928607"> </a>
   /************************* Variable declaration **************************/<a name="wp928608"> </a>
   intn  status;         /* status for functions returning an intn */<a name="wp928610"> </a>
   int32 file_id,        /* HDF file identifier */<a name="wp928611"> </a>
         gr_id,          /* GR interface identifier */<a name="wp928612"> </a>
         ri_id,          /* raster image identifier */<a name="wp928613"> </a>
         start[2],       /* start position to write for each dimension */<a name="wp928614"> </a>
         edges[2],       /* number of elements to be written <a name="wp928615"> </a>
                           along each dimension */<a name="wp928616"> </a>
         dim_sizes[2],   /* dimension sizes of the image array */<a name="wp928617"> </a>
         interlace_mode, /* interlace mode of the image */<a name="wp928618"> </a>
         data_type,      /* data type of the image data */<a name="wp928619"> </a>
         i, j;<a name="wp928620"> </a>
   int16 image_buf[Y_LENGTH][X_LENGTH][N_COMPS];<a name="wp928621"> </a>
   /********************** End of variable declaration **********************/<a name="wp928623"> </a>
   /*<a name="wp928625"> </a>
   * Create and open the file.<a name="wp928626"> </a>
   */<a name="wp928627"> </a>
   file_id = Hopen (FILE_NAME, DFACC_CREATE, 0);<a name="wp928628"> </a>
   /*<a name="wp928630"> </a>
   * Initialize the GR interface.<a name="wp928631"> </a>
   */<a name="wp928632"> </a>
   gr_id = GRstart (file_id);<a name="wp928633"> </a>
   /*<a name="wp928635"> </a>
   * Set the data type, interlace mode, and dimensions of the image.<a name="wp928636"> </a>
   */<a name="wp928637"> </a>
   data_type = DFNT_INT16;<a name="wp928638"> </a>
   interlace_mode = MFGR_INTERLACE_PIXEL;<a name="wp928639"> </a>
   dim_sizes[0] = X_LENGTH;<a name="wp928640"> </a>
   dim_sizes[1] = Y_LENGTH;<a name="wp928641"> </a>
   /*<a name="wp928643"> </a>
   * Create the raster image array.<a name="wp928644"> </a>
   */<a name="wp928645"> </a>
   ri_id = GRcreate (gr_id, IMAGE_NAME, N_COMPS, data_type, <a name="wp928646"> </a>
                     interlace_mode, dim_sizes);<a name="wp928647"> </a>
   /*<a name="wp928649"> </a>
   * Fill the image data buffer with values.<a name="wp928650"> </a>
   */<a name="wp928651"> </a>
   for (i = 0; i &lt; Y_LENGTH; i++)<a name="wp928652"> </a>
   {<a name="wp928653"> </a>
      for (j = 0; j &lt; X_LENGTH; j++)<a name="wp928654"> </a>
      {<a name="wp928655"> </a>
         image_buf[i][j][0] = (i + j) + 1;     /* first component */<a name="wp928656"> </a>
         image_buf[i][j][1] = (i + j) + 1;     /* second component */<a name="wp928657"> </a>
      }<a name="wp928658"> </a>
    }<a name="wp928659"> </a>
   /*<a name="wp928661"> </a>
   * Define the size of the data to be written, i.e., start from the origin<a name="wp928662"> </a>
   * and go as long as the length of each dimension.<a name="wp928663"> </a>
   */<a name="wp928664"> </a>
   start[0] = start[1] = 0;<a name="wp928665"> </a>
   edges[0] = X_LENGTH;<a name="wp928666"> </a>
   edges[1] = Y_LENGTH;<a name="wp928667"> </a>
   /*<a name="wp928669"> </a>
   * Write the data in the buffer into the image array.<a name="wp928670"> </a>
   */<a name="wp928671"> </a>
   status = GRwriteimage(ri_id, start, NULL, edges, (VOIDP)image_buf);<a name="wp928672"> </a>
   /*<a name="wp928674"> </a>
   * Terminate access to the raster image and to the GR interface and, <a name="wp928675"> </a>
   * close the HDF file.<a name="wp928676"> </a>
   */<a name="wp928677"> </a>
   status = GRendaccess (ri_id);<a name="wp928678"> </a>
   status = GRend (gr_id);<a name="wp928679"> </a>
   status = Hclose (file_id);<a name="wp928680"> </a>
}<a name="wp928681"> </a>
</pre></div>
<a name="wp928555"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
create_and_write_image.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program create_raster_image<a name="wp928715"> </a>
      implicit none<a name="wp928720"> </a>
C<a name="wp928721"> </a>
C     Parameter declaration<a name="wp928722"> </a>
C<a name="wp928723"> </a>
      character*19 FILE_NAME<a name="wp928724"> </a>
      character*13 IMAGE_NAME<a name="wp928725"> </a>
      integer      X_LENGTH<a name="wp928726"> </a>
      integer      Y_LENGTH<a name="wp928727"> </a>
      integer      N_COMPS<a name="wp928728"> </a>
C<a name="wp928729"> </a>
      parameter (FILE_NAME  = `General_RImages.hdf&#39;,<a name="wp928730"> </a>
     +           IMAGE_NAME = `Image Array 1&#39;,<a name="wp928731"> </a>
     +           X_LENGTH   = 10,<a name="wp928732"> </a>
     +           Y_LENGTH   = 5,<a name="wp928733"> </a>
     +           N_COMPS    = 2)<a name="wp928734"> </a>
      integer DFACC_CREATE, DFNT_INT16, MFGR_INTERLACE_PIXEL<a name="wp928735"> </a>
      parameter (DFACC_CREATE = 4,<a name="wp928736"> </a>
     +           DFNT_INT16   = 22,<a name="wp928737"> </a>
     +           MFGR_INTERLACE_PIXEL = 0)<a name="wp928738"> </a>
C<a name="wp928739"> </a>
C     Function declaration<a name="wp928740"> </a>
C<a name="wp928741"> </a>
      integer hopen, hclose<a name="wp928742"> </a>
      integer mgstart, mgcreat, mgwrimg, mgendac, mgend <a name="wp928743"> </a>
C<a name="wp928745"> </a>
C**** Variable declaration *******************************************<a name="wp928746"> </a>
C<a name="wp928747"> </a>
      integer status<a name="wp928748"> </a>
      integer file_id<a name="wp928749"> </a>
      integer gr_id, ri_id, num_type, interlace_mode<a name="wp928750"> </a>
      integer start(2), stride(2), edges(2), dimsizes(2)<a name="wp928751"> </a>
      integer i, j, k<a name="wp928752"> </a>
      integer*2  image_buf(N_COMPS, X_LENGTH, Y_LENGTH) <a name="wp928753"> </a>
C<a name="wp928754"> </a>
C**** End of variable declaration ************************************<a name="wp928755"> </a>
C<a name="wp928756"> </a>
C<a name="wp928757"> </a>
C     Create and open the file.<a name="wp928758"> </a>
C<a name="wp928759"> </a>
      file_id = hopen(FILE_NAME, DFACC_CREATE, 0)<a name="wp928760"> </a>
C<a name="wp928761"> </a>
C     Initialize the GR interface.<a name="wp928762"> </a>
C<a name="wp928763"> </a>
      gr_id = mgstart(file_id)<a name="wp928764"> </a>
C<a name="wp928765"> </a>
C     Set the number type, interlace mode, and dimensions of the image.  <a name="wp928766"> </a>
C<a name="wp928767"> </a>
      num_type = DFNT_INT16<a name="wp928768"> </a>
      interlace_mode = MFGR_INTERLACE_PIXEL<a name="wp928769"> </a>
      dimsizes(1) = X_LENGTH<a name="wp928770"> </a>
      dimsizes(2) = Y_lENGTH<a name="wp928771"> </a>
C<a name="wp928772"> </a>
C     Create the raster image array. <a name="wp928773"> </a>
C<a name="wp928774"> </a>
      ri_id = mgcreat(gr_id, IMAGE_NAME, N_COMPS, num_type,<a name="wp928775"> </a>
     +                interlace_mode, dimsizes)<a name="wp928776"> </a>
C<a name="wp928777"> </a>
C     Fill the image data buffer with values. <a name="wp928778"> </a>
C<a name="wp928779"> </a>
      do 30 i = 1, Y_LENGTH<a name="wp928780"> </a>
         do 20 j = 1, X_LENGTH<a name="wp928781"> </a>
            do 10 k = 1, N_COMPS<a name="wp928782"> </a>
               image_buf(k,j,i) = (i+j) - 1<a name="wp928783"> </a>
10          continue<a name="wp928784"> </a>
20       continue<a name="wp928785"> </a>
30    continue<a name="wp928786"> </a>
C     <a name="wp928788"> </a>
C     Define the size of the data to be written, i.e., start from the origin<a name="wp928789"> </a>
C     and go as long as the length of each dimension.<a name="wp928790"> </a>
C<a name="wp928791"> </a>
      start(1) = 0<a name="wp928792"> </a>
      start(2) = 0<a name="wp928793"> </a>
      edges(1) = X_LENGTH<a name="wp928794"> </a>
      edges(2) = Y_LENGTH<a name="wp928795"> </a>
      stride(1) = 1<a name="wp928796"> </a>
      stride(2) = 1<a name="wp928797"> </a>
C<a name="wp928798"> </a>
C     Write the data in the buffer into the image array.<a name="wp928799"> </a>
C<a name="wp928800"> </a>
      status = mgwrimg(ri_id, start, stride, edges, image_buf)<a name="wp928801"> </a>
C<a name="wp928803"> </a>
C     Terminate access to the raster image and to the GR interface, <a name="wp928804"> </a>
C     and close the HDF file.<a name="wp928805"> </a>
C<a name="wp928806"> </a>
      status = mgendac(ri_id)<a name="wp928807"> </a>
      status = mgend(gr_id)<a name="wp928808"> </a>
      status = hclose(file_id)<a name="wp928809"> </a>
      end<a name="wp928810"> </a>
</pre></div>
<a name="wp928828"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
modify_image.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp928970"> </a>
#define  FILE_NAME    &quot;General_RImages.hdf&quot;<a name="wp928838"> </a>
#define  X1_LENGTH    5     /* number of columns in the first image <a name="wp928839"> </a>
                              being modified */<a name="wp928840"> </a>
#define  Y1_LENGTH    2     /* number of rows in the first image <a name="wp928841"> </a>
                              being modified */<a name="wp928842"> </a>
#define  N1_COMPS     2     /* number of components in the first image */<a name="wp928843"> </a>
#define  IMAGE1_NAME  &quot;Image Array 1&quot;<a name="wp928844"> </a>
#define  IMAGE2_NAME  &quot;Image Array 2&quot;<a name="wp928845"> </a>
#define  X2_LENGTH    6     /* number of columns in the second image */<a name="wp928846"> </a>
#define  Y2_LENGTH    4     /* number of rows in the second image */<a name="wp928847"> </a>
#define  N2_COMPS     3     /* number of components in the second image */<a name="wp928848"> </a>
main( ) <a name="wp928850"> </a>
{<a name="wp928851"> </a>
   /************************* Variable declaration **************************/<a name="wp928852"> </a>
   intn  status;         /* status for functions returning an intn */<a name="wp928854"> </a>
   int32 file_id,        /* HDF file identifier */<a name="wp928855"> </a>
         gr_id,          /* GR interface identifier */<a name="wp928856"> </a>
         ri1_id,         /* raster image identifier */<a name="wp928857"> </a>
         start1[2],      /* start position to write for each dimension */<a name="wp928858"> </a>
         edges1[2],      /* number of elements to be written along<a name="wp928859"> </a>
                           each dimension */<a name="wp928860"> </a>
         ri2_id,         /* raster image identifier */<a name="wp928861"> </a>
         start2[2],      /* start position to write for each dimension */<a name="wp928862"> </a>
         edges2[2],      /* number of elements to be written along <a name="wp928863"> </a>
                           each dimension */<a name="wp928864"> </a>
         dims_sizes[2],  /* sizes of the two dimensions of the image array */<a name="wp928865"> </a>
         data_type,      /* data type of the image data */<a name="wp928866"> </a>
         interlace_mode; /* interlace mode of the image */<a name="wp928867"> </a>
   int16 i, j;           /* indices for the dimensions */<a name="wp928868"> </a>
   int16 image1_buf[Y1_LENGTH][X1_LENGTH][N1_COMPS]; /* data of first image */<a name="wp928869"> </a>
   char  image2_buf[Y2_LENGTH][X2_LENGTH][N2_COMPS]; /* data of second image*/<a name="wp928870"> </a>
   /********************** End of variable declaration **********************/<a name="wp928872"> </a>
   /*<a name="wp928874"> </a>
   * Open the HDF file for writing.<a name="wp928875"> </a>
   */<a name="wp928876"> </a>
   file_id = Hopen (FILE_NAME, DFACC_WRITE, 0);<a name="wp928877"> </a>
   /*<a name="wp928879"> </a>
   * Initialize the GR interface.<a name="wp928880"> </a>
   */<a name="wp928881"> </a>
   gr_id = GRstart (file_id);<a name="wp928882"> </a>
   /*<a name="wp928884"> </a>
   * Select the first raster image in the file.<a name="wp928885"> </a>
   */<a name="wp928886"> </a>
   ri1_id = GRselect (gr_id, 0);<a name="wp928887"> </a>
   /*<a name="wp928889"> </a>
   * Fill the first image data buffer with values.<a name="wp928890"> </a>
   */<a name="wp928891"> </a>
   for (i = 0; i &lt; Y1_LENGTH; i++)<a name="wp928892"> </a>
   {<a name="wp928893"> </a>
      for (j = 0; j &lt; X1_LENGTH; j++)<a name="wp928894"> </a>
      {<a name="wp928895"> </a>
         image1_buf[i][j][0] = 0;  /* first component */ <a name="wp928896"> </a>
         image1_buf[i][j][1] = 0;  /* second component */ <a name="wp928897"> </a>
      }<a name="wp928898"> </a>
    }<a name="wp928899"> </a>
   /*<a name="wp928901"> </a>
   * Define the size of the data to be written, i.e., start from the origin<a name="wp928902"> </a>
   * and go as long as the length of each dimension.<a name="wp928903"> </a>
   */<a name="wp928904"> </a>
   start1[0] = start1[1] = 0;<a name="wp928905"> </a>
   edges1[0] = X1_LENGTH;<a name="wp928906"> </a>
   edges1[1] = Y1_LENGTH;<a name="wp928907"> </a>
   /*<a name="wp928909"> </a>
   * Write the data in the buffer into the image array.<a name="wp928910"> </a>
   */<a name="wp928911"> </a>
   status = GRwriteimage (ri1_id, start1, NULL, edges1, (VOIDP)image1_buf);<a name="wp928912"> </a>
   /*<a name="wp928915"> </a>
   * Set the interlace mode and dimensions of the second image.<a name="wp928916"> </a>
   */<a name="wp928917"> </a>
   data_type = DFNT_CHAR8;<a name="wp928918"> </a>
   interlace_mode = MFGR_INTERLACE_PIXEL;<a name="wp928919"> </a>
   dims_sizes[0] = X2_LENGTH;<a name="wp928920"> </a>
   dims_sizes[1] = Y2_LENGTH;<a name="wp928921"> </a>
   /*<a name="wp928923"> </a>
   * Create the second image in the file.<a name="wp928924"> </a>
   */<a name="wp928925"> </a>
   ri2_id = GRcreate (gr_id, IMAGE2_NAME, N2_COMPS, data_type,<a name="wp928926"> </a>
                                interlace_mode, dims_sizes);<a name="wp928927"> </a>
   /*<a name="wp928929"> </a>
   * Fill the second image data buffer with values.<a name="wp928930"> </a>
   */<a name="wp928931"> </a>
   for (i = 0; i &lt; Y2_LENGTH; i++)<a name="wp928932"> </a>
   {<a name="wp928933"> </a>
      for (j = 0; j &lt; X2_LENGTH; j++)<a name="wp928934"> </a>
      {<a name="wp928935"> </a>
         image2_buf[i][j][0] = `A&#39;;     /* first component */ <a name="wp928936"> </a>
         image2_buf[i][j][1] = `B&#39;;     /* second component */<a name="wp928937"> </a>
         image2_buf[i][j][2] = `C&#39;;     /* third component */<a name="wp928938"> </a>
      }<a name="wp928939"> </a>
    }<a name="wp928940"> </a>
   /*<a name="wp928942"> </a>
   * Define the size of the data to be written, i.e., start from the origin<a name="wp928943"> </a>
   * and go as long as the length of each dimension.<a name="wp928944"> </a>
   */<a name="wp928945"> </a>
   for (i = 0; i &lt; 2; i++) {<a name="wp928946"> </a>
      start2[i] = 0;<a name="wp928947"> </a>
      edges2[i] = dims_sizes[i];<a name="wp928948"> </a>
   }<a name="wp928949"> </a>
   /*<a name="wp928951"> </a>
   * Write the data in the buffer into the second image array.<a name="wp928952"> </a>
   */<a name="wp928953"> </a>
   status = GRwriteimage (ri2_id, start2, NULL, edges2, (VOIDP)image2_buf);<a name="wp928954"> </a>
   /*<a name="wp928956"> </a>
   * Terminate access to the raster images and to the GR interface, and<a name="wp928957"> </a>
   * close the HDF file.<a name="wp928958"> </a>
   */<a name="wp928959"> </a>
   status = GRendaccess (ri1_id);<a name="wp928960"> </a>
   status = GRendaccess (ri2_id);<a name="wp928961"> </a>
   status = GRend (gr_id);<a name="wp928962"> </a>
   status = Hclose (file_id);<a name="wp928963"> </a>
}<a name="wp928964"> </a>
</pre></div>
<a name="wp928829"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
modify_image.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program modify_image<a name="wp928973"> </a>
      implicit none<a name="wp928978"> </a>
C<a name="wp928979"> </a>
C     Parameter declaration<a name="wp928980"> </a>
C<a name="wp928981"> </a>
      character*19 FILE_NAME<a name="wp928982"> </a>
      character*13 IMAGE1_NAME<a name="wp928983"> </a>
      integer      X1_LENGTH<a name="wp928984"> </a>
      integer      Y1_LENGTH<a name="wp928985"> </a>
      integer      N1_COMPS<a name="wp928986"> </a>
      character*13 IMAGE2_NAME<a name="wp928987"> </a>
      integer      X2_LENGTH<a name="wp928988"> </a>
      integer      Y2_LENGTH<a name="wp928989"> </a>
      integer      N2_COMPS<a name="wp928990"> </a>
C<a name="wp928991"> </a>
      parameter (FILE_NAME   = `General_RImages.hdf&#39;,<a name="wp928992"> </a>
     +           IMAGE1_NAME = `Image Array 1&#39;,<a name="wp928993"> </a>
     +           IMAGE2_NAME = `Image Array 2&#39;,<a name="wp928994"> </a>
     +           X1_LENGTH   = 5,<a name="wp928995"> </a>
     +           Y1_LENGTH   = 2,<a name="wp928996"> </a>
     +           N1_COMPS    = 2,<a name="wp928997"> </a>
     +           X2_LENGTH   = 6,<a name="wp928998"> </a>
     +           Y2_LENGTH   = 4,<a name="wp928999"> </a>
     +           N2_COMPS    = 3)<a name="wp929000"> </a>
      integer DFACC_WRITE, DFNT_INT16, DFNT_CHAR8,<a name="wp929001"> </a>
     +        MFGR_INTERLACE_PIXEL<a name="wp929002"> </a>
      parameter (DFACC_WRITE  = 2,<a name="wp929003"> </a>
     +           DFNT_CHAR8   = 4,<a name="wp929004"> </a>
     +           DFNT_INT16   = 22,<a name="wp929005"> </a>
     +           MFGR_INTERLACE_PIXEL = 0)<a name="wp929006"> </a>
C<a name="wp929007"> </a>
C     Function declaration<a name="wp929008"> </a>
C<a name="wp929009"> </a>
      integer hopen, hclose<a name="wp929010"> </a>
      integer mgstart, mgselct, mgcreat, mgwrimg, mgendac, mgend <a name="wp929011"> </a>
C<a name="wp929013"> </a>
C**** Variable declaration *******************************************<a name="wp929014"> </a>
C<a name="wp929015"> </a>
      integer status<a name="wp929016"> </a>
      integer file_id<a name="wp929017"> </a>
      integer gr_id, ri1_id, ri2_id, data_type, interlace_mode<a name="wp929018"> </a>
      integer start1(2), stride1(2), edges1(2)<a name="wp929019"> </a>
      integer start2(2), stride2(2), edges2(2), dim_sizes(2)<a name="wp929020"> </a>
      integer i, j, k<a name="wp929021"> </a>
      integer*2  image1_buf(N1_COMPS, X1_LENGTH, Y1_LENGTH) <a name="wp929022"> </a>
      character  image2_buf(N2_COMPS, X2_LENGTH, Y2_LENGTH)<a name="wp929023"> </a>
C<a name="wp929024"> </a>
C**** End of variable declaration ************************************<a name="wp929025"> </a>
C<a name="wp929026"> </a>
C<a name="wp929027"> </a>
C     Open the HDF file for writing.<a name="wp929028"> </a>
C<a name="wp929029"> </a>
      file_id = hopen(FILE_NAME, DFACC_WRITE, 0)<a name="wp929030"> </a>
C<a name="wp929031"> </a>
C     Initialize the GR interface.<a name="wp929032"> </a>
C<a name="wp929033"> </a>
      gr_id = mgstart(file_id)<a name="wp929034"> </a>
C<a name="wp929035"> </a>
C     Select the first raster image in the file.<a name="wp929036"> </a>
C<a name="wp929037"> </a>
      ri1_id = mgselct(gr_id, 0)<a name="wp929038"> </a>
C<a name="wp929039"> </a>
C     Fill the buffer with values.<a name="wp929040"> </a>
C<a name="wp929041"> </a>
      do 20 i = 1, Y1_LENGTH<a name="wp929042"> </a>
         do 10 j = 1, X1_LENGTH<a name="wp929043"> </a>
               image1_buf(1,j,i) = 0 <a name="wp929044"> </a>
               image1_buf(2,j,i) = 0 <a name="wp929045"> </a>
10       continue<a name="wp929046"> </a>
20    continue<a name="wp929047"> </a>
C<a name="wp929048"> </a>
C     Define the part of the data in the first image that will be overwritten<a name="wp929049"> </a>
C     with the new values from image1_buf.<a name="wp929050"> </a>
C<a name="wp929051"> </a>
      start1(1) = 0<a name="wp929052"> </a>
      start1(2) = 0<a name="wp929053"> </a>
      edges1(1) = X1_LENGTH<a name="wp929054"> </a>
      edges1(2) = Y1_LENGTH<a name="wp929055"> </a>
      stride1(1) = 1<a name="wp929056"> </a>
      stride1(2) = 1<a name="wp929057"> </a>
C<a name="wp929058"> </a>
C     Write the data in the buffer into the image array.<a name="wp929059"> </a>
C<a name="wp929060"> </a>
      status = mgwrimg(ri1_id, start1, stride1, edges1, image1_buf)<a name="wp929061"> </a>
C<a name="wp929063"> </a>
C     Set the number type, interlace mode, and dimensions of the second image.  <a name="wp929064"> </a>
C<a name="wp929065"> </a>
      data_type = DFNT_CHAR8<a name="wp929066"> </a>
      interlace_mode = MFGR_INTERLACE_PIXEL<a name="wp929067"> </a>
      dim_sizes(1) = X2_LENGTH<a name="wp929068"> </a>
      dim_sizes(2) = Y2_LENGTH<a name="wp929069"> </a>
C<a name="wp929070"> </a>
C     Create the second image in the file.<a name="wp929071"> </a>
C<a name="wp929072"> </a>
      ri2_id = mgcreat(gr_id, IMAGE2_NAME, N2_COMPS, data_type,<a name="wp929073"> </a>
     +                interlace_mode, dim_sizes)<a name="wp929074"> </a>
C<a name="wp929075"> </a>
C     Fill the image data buffer with values. <a name="wp929076"> </a>
C<a name="wp929077"> </a>
      do 60 i = 1, Y2_LENGTH <a name="wp929078"> </a>
         do 50 j = 1, X2_LENGTH<a name="wp929079"> </a>
            do 40 k = 1, N2_COMPS <a name="wp929080"> </a>
               image2_buf(k,j,i) = char(65 + k - 1) <a name="wp929081"> </a>
40          continue<a name="wp929082"> </a>
50       continue<a name="wp929083"> </a>
60    continue<a name="wp929084"> </a>
C     <a name="wp929086"> </a>
C     Define the size of the data to be written, i.e., start from the origin<a name="wp929087"> </a>
C     and go as long as the length of each dimension.<a name="wp929088"> </a>
C<a name="wp929089"> </a>
      start2(1) = 0<a name="wp929090"> </a>
      start2(2) = 0<a name="wp929091"> </a>
      edges2(1) =  dim_sizes(1)<a name="wp929092"> </a>
      edges2(2) =  dim_sizes(2) <a name="wp929093"> </a>
      stride2(1) = 1<a name="wp929094"> </a>
      stride2(2) = 1<a name="wp929095"> </a>
C<a name="wp929096"> </a>
C     Write the data in the buffer into the image array.<a name="wp929097"> </a>
C<a name="wp929098"> </a>
      status = mgwrimg(ri2_id, start2, stride2, edges2, image2_buf)<a name="wp929099"> </a>
C<a name="wp929101"> </a>
C     Terminate access to the raster images and to the GR interface,<a name="wp929102"> </a>
C     and close the HDF file.<a name="wp929103"> </a>
C<a name="wp929104"> </a>
      status = mgendac(ri1_id)<a name="wp929105"> </a>
      status = mgendac(ri2_id)<a name="wp929106"> </a>
      status = mgend(gr_id)<a name="wp929107"> </a>
      status = hclose(file_id)<a name="wp929108"> </a>
      end<a name="wp929109"> </a>
</pre></div>
<a name="wp928565"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
read_image.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp929119"> </a>
#define  FILE_NAME       &quot;General_RImages.hdf&quot;<a name="wp929125"> </a>
#define  N_COMPS         2<a name="wp929126"> </a>
#define  X_LENGTH        10   /* number of columns of the entire image */<a name="wp929127"> </a>
#define  Y_LENGTH        5    /* number of rows of the entire image */<a name="wp929128"> </a>
#define  PART_COLS       2    /* number of columns read for partial image */<a name="wp929129"> </a>
#define  PART_ROWS       3    /* number of rows read for partial image */<a name="wp929130"> </a>
#define  SKIP_COLS       5    /* number of columns read for skipped image */<a name="wp929131"> </a>
#define  SKIP_ROWS       3    /* number of rows read for skipped image */<a name="wp929132"> </a>
#define  COLS_PART_START 3    /* starting column to read partial image */<a name="wp929133"> </a>
#define  ROWS_PART_START 1    /* starting row to read partial image */<a name="wp929134"> </a>
#define  COLS_SKIP_START 1    /* starting column to read skipped image */<a name="wp929135"> </a>
#define  ROWS_SKIP_START 0    /* starting row to read skipped image */<a name="wp929136"> </a>
#define  N_STRIDES       2    /* number of elements to skip on each dim. */<a name="wp929137"> </a>
main( )<a name="wp929139"> </a>
{<a name="wp929140"> </a>
   /************************* Variable declaration **************************/<a name="wp929141"> </a>
   intn  status;        /* status for functions returning an intn */<a name="wp929143"> </a>
   int32 index;<a name="wp929144"> </a>
   int32 file_id, gr_id, ri_id,<a name="wp929145"> </a>
         start[2],      /* start position to write for each dimension */<a name="wp929146"> </a>
         edges[2],      /* number of elements to bewritten along <a name="wp929147"> </a>
                           each dimension */<a name="wp929148"> </a>
         stride[2],     /* number of elements to skip on each dimension */<a name="wp929149"> </a>
         dim_sizes[2];  /* dimension sizes of the image array */<a name="wp929150"> </a>
   int16 entire_image[Y_LENGTH][X_LENGTH][N_COMPS],<a name="wp929151"> </a>
         partial_image[PART_ROWS][PART_COLS][N_COMPS],<a name="wp929152"> </a>
         skipped_image[SKIP_ROWS][SKIP_COLS][N_COMPS];<a name="wp929153"> </a>
   int32 i, j;<a name="wp929154"> </a>
   /********************** End of variable declaration **********************/<a name="wp929156"> </a>
   /*<a name="wp929158"> </a>
   * Open the HDF file for reading.<a name="wp929159"> </a>
   */<a name="wp929160"> </a>
   file_id = Hopen (FILE_NAME, DFACC_READ, 0);<a name="wp929161"> </a>
   /*<a name="wp929163"> </a>
   * Initialize the GR interface.<a name="wp929164"> </a>
   */<a name="wp929165"> </a>
   gr_id = GRstart (file_id);<a name="wp929166"> </a>
   /*<a name="wp929168"> </a>
   * Select the first raster image in the file.<a name="wp929169"> </a>
   */<a name="wp929170"> </a>
   ri_id = GRselect (gr_id, 0);<a name="wp929171"> </a>
   /*<a name="wp929173"> </a>
   * Define the size of the data to be read, i.e., start from the origin <a name="wp929174"> </a>
   * and go as long as the length of each dimension.<a name="wp929175"> </a>
   */<a name="wp929176"> </a>
   start[0] = start[1] = 0;<a name="wp929177"> </a>
   edges[0] = X_LENGTH;<a name="wp929178"> </a>
   edges[1] = Y_LENGTH;<a name="wp929179"> </a>
   /*<a name="wp929181"> </a>
   * Read the data from the raster image array.<a name="wp929182"> </a>
   */<a name="wp929183"> </a>
   status = GRreadimage (ri_id, start, NULL, edges, (VOIDP)entire_image);<a name="wp929184"> </a>
   /*<a name="wp929186"> </a>
   * Display only the first component of the image since the two components <a name="wp929187"> </a>
   * have the same data in this example.<a name="wp929188"> </a>
   */<a name="wp929189"> </a>
   printf (&quot;First component of the entire image:\n&quot;);<a name="wp929190"> </a>
   for (i = 0; i &lt; Y_LENGTH; i++)<a name="wp929191"> </a>
   {<a name="wp929192"> </a>
      for (j = 0; j &lt; X_LENGTH; j++)<a name="wp929193"> </a>
         printf (&quot;%d &quot;, entire_image[i][j][0]);<a name="wp929194"> </a>
      printf (&quot;\n&quot;);<a name="wp929195"> </a>
   }<a name="wp929196"> </a>
   /*<a name="wp929198"> </a>
   * Define the size of the data to be read.<a name="wp929199"> </a>
   */<a name="wp929200"> </a>
   start[0] = COLS_PART_START;<a name="wp929201"> </a>
   start[1] = ROWS_PART_START;<a name="wp929202"> </a>
   edges[0] = PART_COLS;<a name="wp929203"> </a>
   edges[1] = PART_ROWS;<a name="wp929204"> </a>
   /*<a name="wp929206"> </a>
   * Read a subset of the raster image array.<a name="wp929207"> </a>
   */<a name="wp929208"> </a>
   status = GRreadimage (ri_id, start, NULL, edges, (VOIDP)partial_image);<a name="wp929209"> </a>
   /*<a name="wp929211"> </a>
   * Display the first component of the read sample.<a name="wp929212"> </a>
   */<a name="wp929213"> </a>
   printf (&quot;\nThree rows &amp; two cols at 2nd row and 4th column&quot;);<a name="wp929214"> </a>
   printf (&quot; of the first component:\n&quot;);<a name="wp929215"> </a>
   for (i = 0; i &lt; PART_ROWS; i++)<a name="wp929216"> </a>
   {<a name="wp929217"> </a>
      for (j = 0; j &lt; PART_COLS; j++)<a name="wp929218"> </a>
         printf (&quot;%d &quot;, partial_image[i][j][0]);<a name="wp929219"> </a>
      printf (&quot;\n&quot;);<a name="wp929220"> </a>
   }<a name="wp929221"> </a>
   /*<a name="wp929223"> </a>
   * Define the size and the pattern to read the data.<a name="wp929224"> </a>
   */<a name="wp929225"> </a>
   start[0] = COLS_SKIP_START;<a name="wp929226"> </a>
   start[1] = ROWS_SKIP_START;<a name="wp929227"> </a>
   edges[0] = SKIP_COLS;<a name="wp929228"> </a>
   edges[1] = SKIP_ROWS;<a name="wp929229"> </a>
   stride[0] = stride[1] = N_STRIDES;<a name="wp929230"> </a>
   /*<a name="wp929232"> </a>
   * Read all the odd rows and even columns of the image.<a name="wp929233"> </a>
   */<a name="wp929234"> </a>
   status = GRreadimage (ri_id, start, stride, edges, (VOIDP)skipped_image);<a name="wp929235"> </a>
   /*<a name="wp929237"> </a>
   * Display the first component of the read sample.<a name="wp929238"> </a>
   */<a name="wp929239"> </a>
   printf (&quot;\nAll odd rows and even columns of the first component:\n&quot;);<a name="wp929240"> </a>
   for (i = 0; i &lt; SKIP_ROWS; i++)<a name="wp929241"> </a>
   {<a name="wp929242"> </a>
      for (j = 0; j &lt; SKIP_COLS; j++)<a name="wp929243"> </a>
         printf (&quot;%d &quot;, skipped_image[i][j][0]);<a name="wp929244"> </a>
      printf (&quot;\n&quot;);<a name="wp929245"> </a>
   }<a name="wp929246"> </a>
   /*<a name="wp929248"> </a>
   * Terminate access to the raster image and to the GR interface, and<a name="wp929249"> </a>
   * close the HDF file.<a name="wp929250"> </a>
   */<a name="wp929251"> </a>
   status = GRendaccess (ri_id);<a name="wp929252"> </a>
   status = GRend (gr_id);<a name="wp929253"> </a>
   status = Hclose (file_id);<a name="wp929254"> </a>
}<a name="wp929255"> </a>
</pre></div>
<a name="wp928567"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
read_image.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program read_raster_image<a name="wp929269"> </a>
      implicit none<a name="wp929274"> </a>
C<a name="wp929275"> </a>
C     Parameter declaration<a name="wp929276"> </a>
C<a name="wp929277"> </a>
      character*19 FILE_NAME<a name="wp929278"> </a>
      integer      X_LENGTH<a name="wp929279"> </a>
      integer      Y_LENGTH<a name="wp929280"> </a>
      integer      N_COMPS<a name="wp929281"> </a>
C<a name="wp929282"> </a>
      parameter (FILE_NAME  = `General_RImages.hdf&#39;,<a name="wp929283"> </a>
     +           X_LENGTH   = 10,<a name="wp929284"> </a>
     +           Y_LENGTH   = 5,<a name="wp929285"> </a>
     +           N_COMPS    = 2)<a name="wp929286"> </a>
      integer PART_COLS, PART_ROWS, SKIP_COLS, SKIP_ROWS<a name="wp929287"> </a>
      integer COLS_PART_START, ROWS_PART_START<a name="wp929288"> </a>
      integer COLS_SKIP_START, ROWS_SKIP_START<a name="wp929289"> </a>
      integer N_STRIDES<a name="wp929290"> </a>
      parameter (PART_COLS = 3, PART_ROWS = 2,<a name="wp929291"> </a>
     +           SKIP_COLS = 3, SKIP_ROWS = 5,<a name="wp929292"> </a>
     +           COLS_PART_START = 1, ROWS_PART_START = 3,<a name="wp929293"> </a>
     +           COLS_SKIP_START = 0, ROWS_SKIP_START = 1,<a name="wp929294"> </a>
     +           N_STRIDES = 2)<a name="wp929295"> </a>
      integer DFACC_READ<a name="wp929296"> </a>
      parameter (DFACC_READ = 1)<a name="wp929297"> </a>
C<a name="wp929298"> </a>
C     Function declaration<a name="wp929299"> </a>
C<a name="wp929300"> </a>
      integer hopen, hclose<a name="wp929301"> </a>
      integer mgstart, mgselct, mgrdimg, mgendac, mgend <a name="wp929302"> </a>
C<a name="wp929304"> </a>
C**** Variable declaration *******************************************<a name="wp929305"> </a>
C<a name="wp929306"> </a>
      integer status<a name="wp929307"> </a>
      integer file_id<a name="wp929308"> </a>
      integer gr_id, ri_id<a name="wp929309"> </a>
      integer start(2), stride(2), edges(2)<a name="wp929310"> </a>
      integer i, j<a name="wp929311"> </a>
      integer*2  entire_image(N_COMPS, X_LENGTH, Y_LENGTH) <a name="wp929312"> </a>
      integer*2  partial_image(N_COMPS, PART_ROWS, PART_COLS) <a name="wp929313"> </a>
      integer*2  skipped_image(N_COMPS, SKIP_ROWS, SKIP_COLS) <a name="wp929314"> </a>
C<a name="wp929315"> </a>
C**** End of variable declaration ************************************<a name="wp929316"> </a>
C<a name="wp929317"> </a>
C<a name="wp929318"> </a>
C     Open the HDF file for reading.<a name="wp929319"> </a>
C<a name="wp929320"> </a>
      file_id = hopen(FILE_NAME, DFACC_READ, 0)<a name="wp929321"> </a>
C<a name="wp929322"> </a>
C     Initialize the GR interface.<a name="wp929323"> </a>
C<a name="wp929324"> </a>
      gr_id = mgstart(file_id)<a name="wp929325"> </a>
C<a name="wp929326"> </a>
C     Select the first raster image in the file.<a name="wp929327"> </a>
C<a name="wp929328"> </a>
      ri_id = mgselct(gr_id, 0)<a name="wp929329"> </a>
C     <a name="wp929330"> </a>
C     Define the size of the data to be read, i.e., start from the origin<a name="wp929331"> </a>
C     and go as long as the length of each dimension.<a name="wp929332"> </a>
C<a name="wp929333"> </a>
      start(1) = 0<a name="wp929334"> </a>
      start(2) = 0<a name="wp929335"> </a>
      edges(1) = X_LENGTH<a name="wp929336"> </a>
      edges(2) = Y_LENGTH<a name="wp929337"> </a>
      stride(1) = 1<a name="wp929338"> </a>
      stride(2) = 1<a name="wp929339"> </a>
C<a name="wp929340"> </a>
C     Read the data from the raster image array. <a name="wp929341"> </a>
C<a name="wp929342"> </a>
      status = mgrdimg(ri_id, start, stride, edges, entire_image)<a name="wp929343"> </a>
C<a name="wp929344"> </a>
C     Display only the first component of the image since the two components<a name="wp929345"> </a>
C     have the same data in this example.<a name="wp929346"> </a>
C<a name="wp929347"> </a>
      write(*,*) `First component of the entire image&#39;<a name="wp929348"> </a>
      write(*,*)<a name="wp929349"> </a>
      do 10 i = 1, X_LENGTH<a name="wp929350"> </a>
         write(*,1000) (entire_image(1,i,j), j = 1, Y_LENGTH)<a name="wp929351"> </a>
10    continue<a name="wp929352"> </a>
      write(*,*)<a name="wp929353"> </a>
C<a name="wp929354"> </a>
C     Define the size of the data to be read.<a name="wp929355"> </a>
C<a name="wp929356"> </a>
      start(1) = ROWS_PART_START<a name="wp929357"> </a>
      start(2) = COLS_PART_START <a name="wp929358"> </a>
      edges(1) = PART_ROWS <a name="wp929359"> </a>
      edges(2) = PART_COLS <a name="wp929360"> </a>
      stride(1) = 1<a name="wp929361"> </a>
      stride(2) = 1<a name="wp929362"> </a>
C<a name="wp929363"> </a>
C     Read a subset of the raster image array. <a name="wp929364"> </a>
C<a name="wp929365"> </a>
      status = mgrdimg(ri_id, start, stride, edges, partial_image)<a name="wp929366"> </a>
C<a name="wp929367"> </a>
C     Display only the first component of the read sample. <a name="wp929368"> </a>
C<a name="wp929369"> </a>
      write(*,*)<a name="wp929370"> </a>
     +  `Two rows and three columns at 4th row and 2nd column&#39;,<a name="wp929371"> </a>
     +  ` of the first component&#39;<a name="wp929372"> </a>
      write(*,*)<a name="wp929373"> </a>
      do 20 i = 1, PART_ROWS<a name="wp929374"> </a>
         write(*,1000) (partial_image(1,i,j), j = 1, PART_COLS)<a name="wp929375"> </a>
20    continue<a name="wp929376"> </a>
      write(*,*)<a name="wp929377"> </a>
C<a name="wp929378"> </a>
C     Define the size and the pattern to read the data.<a name="wp929379"> </a>
C<a name="wp929380"> </a>
      start(1) = ROWS_SKIP_START<a name="wp929381"> </a>
      start(2) = COLS_SKIP_START <a name="wp929382"> </a>
      edges(1) = SKIP_ROWS <a name="wp929383"> </a>
      edges(2) = SKIP_COLS <a name="wp929384"> </a>
      stride(1) = N_STRIDES <a name="wp929385"> </a>
      stride(2) = N_STRIDES <a name="wp929386"> </a>
C<a name="wp929387"> </a>
C     Read all the odd rows and even columns of the image.<a name="wp929388"> </a>
C<a name="wp929389"> </a>
      status = mgrdimg(ri_id, start, stride, edges, skipped_image)<a name="wp929390"> </a>
C<a name="wp929391"> </a>
C     Display only the first component of the read sample. <a name="wp929392"> </a>
C<a name="wp929393"> </a>
      write(*,*) `All even rows and odd columns of the first component&#39;<a name="wp929394"> </a>
      write(*,*)<a name="wp929395"> </a>
      do 30 i = 1, SKIP_ROWS<a name="wp929396"> </a>
         write(*,1000) (skipped_image(1,i,j), j = 1, SKIP_COLS)<a name="wp929397"> </a>
30    continue<a name="wp929398"> </a>
      write(*,*)<a name="wp929399"> </a>
C<a name="wp929400"> </a>
C     Terminate access to the raster image and to the GR interface, <a name="wp929401"> </a>
C     and close the HDF file.<a name="wp929402"> </a>
C<a name="wp929403"> </a>
      status = mgendac(ri_id)<a name="wp929404"> </a>
      status = mgend(gr_id)<a name="wp929405"> </a>
      status = hclose(file_id)<a name="wp929406"> </a>
1000  format(1x, 5(I4))<a name="wp929407"> </a>
      end<a name="wp929408"> </a>
</pre></div>
<a name="wp928569"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
image_info.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp929418"> </a>
#define  FILE_NAME    &quot;General_RImages.hdf&quot;<a name="wp929424"> </a>
main( ) <a name="wp929426"> </a>
{<a name="wp929427"> </a>
   /************************* Variable declaration **************************/<a name="wp929428"> </a>
   intn  status;            /* status for functions returning an intn */<a name="wp929430"> </a>
   int32 file_id, gr_id, ri_id,<a name="wp929431"> </a>
         n_rimages,         /* number of raster images in the file */<a name="wp929432"> </a>
         n_file_attrs,      /* number of file attributes */<a name="wp929433"> </a>
         ri_index,          /* index of a image */<a name="wp929434"> </a>
         dim_sizes[2],      /* dimensions of an image */<a name="wp929435"> </a>
         n_comps,           /* number of components an image contains */<a name="wp929436"> </a>
         interlace_mode,    /* interlace mode of an image */ <a name="wp929437"> </a>
         data_type,         /* number type of an image */<a name="wp929438"> </a>
         n_attrs;           /* number of attributes belong to an image */<a name="wp929439"> </a>
   char  name[MAX_GR_NAME], /* name of an image */<a name="wp929440"> </a>
        *type_string,       /* mapped text of a number type */<a name="wp929441"> </a>
        *interlace_string;  /* mapped text of an interlace mode */<a name="wp929442"> </a>
   /********************** End of variable declaration **********************/<a name="wp929444"> </a>
   /*<a name="wp929446"> </a>
   * Open the file for reading.<a name="wp929447"> </a>
   */<a name="wp929448"> </a>
   file_id = Hopen (FILE_NAME, DFACC_READ, 0);<a name="wp929449"> </a>
   /*<a name="wp929451"> </a>
   * Initialize the GR interface.<a name="wp929452"> </a>
   */<a name="wp929453"> </a>
   gr_id = GRstart (file_id);<a name="wp929454"> </a>
   /*<a name="wp929456"> </a>
   * Determine the contents of the file.<a name="wp929457"> </a>
   */<a name="wp929458"> </a>
   status = GRfileinfo (gr_id, &amp;n_rimages, &amp;n_file_attrs);<a name="wp929459"> </a>
   /*<a name="wp929461"> </a>
   * For each image in the file, get and display the image information.<a name="wp929462"> </a>
   */<a name="wp929463"> </a>
   printf (&quot;RI#    Name       Components  Type         Interlace     \<a name="wp929464"> </a>
   Dimensions   Attributes\n\n&quot;);<a name="wp929465"> </a>
   for (ri_index = 0; ri_index &lt; n_rimages; ri_index++)<a name="wp929466"> </a>
   {<a name="wp929467"> </a>
      ri_id = GRselect (gr_id, ri_index);<a name="wp929468"> </a>
      status = GRgetiminfo (ri_id, name, &amp;n_comps, &amp;data_type, <a name="wp929469"> </a>
                          &amp;interlace_mode, dim_sizes, &amp;n_attrs);<a name="wp929470"> </a>
      /*<a name="wp929471"> </a>
      * Map the number type and interlace mode into text strings for output <a name="wp929472"> </a>
      * readability.  Note that, in this example, only two possible types <a name="wp929473"> </a>
      * are considered because of the simplicity of the example.  For real <a name="wp929474"> </a>
      * problems, all possible types should be checked and, if reading the<a name="wp929475"> </a>
      * data is desired, the size of the type must be determined based on the<a name="wp929476"> </a>
      * machine where the program resides.<a name="wp929477"> </a>
      */<a name="wp929478"> </a>
      if (data_type == DFNT_CHAR8)<a name="wp929479"> </a>
         type_string = &quot;Char8&quot;;<a name="wp929480"> </a>
      else if (data_type == DFNT_INT16)<a name="wp929481"> </a>
         type_string = &quot;Int16&quot;;<a name="wp929482"> </a>
      else<a name="wp929483"> </a>
         type_string = &quot;Unknown&quot;;<a name="wp929484"> </a>
      switch (interlace_mode)<a name="wp929486"> </a>
      {<a name="wp929487"> </a>
         case MFGR_INTERLACE_PIXEL:<a name="wp929488"> </a>
            interlace_string = &quot;MFGR_INTERLACE_PIXEL&quot;;<a name="wp929489"> </a>
            break;<a name="wp929490"> </a>
         case MFGR_INTERLACE_LINE:<a name="wp929491"> </a>
            interlace_string = &quot;MFGR_INTERLACE_LINE&quot;;<a name="wp929492"> </a>
            break;<a name="wp929493"> </a>
         case MFGR_INTERLACE_COMPONENT:<a name="wp929494"> </a>
            interlace_string = &quot;MFGR_INTERLACE_COMPONENT&quot;;<a name="wp929495"> </a>
            break;<a name="wp929496"> </a>
         default:<a name="wp929497"> </a>
            interlace_string = &quot;Unknown&quot;;<a name="wp929498"> </a>
            break;<a name="wp929499"> </a>
      } /* switch */<a name="wp929500"> </a>
 <a name="wp929501"> </a>
      /*<a name="wp929502"> </a>
      * Display the image information for the current raster image.<a name="wp929503"> </a>
      */<a name="wp929504"> </a>
          printf (&quot;%d  %s       %d      %s   %s     %2d,%2d         %d\n&quot;, <a name="wp929505"> </a>
                 ri_index, name, n_comps, type_string, interlace_string,<a name="wp929506"> </a>
                 dim_sizes[0], dim_sizes[1], n_attrs);<a name="wp929507"> </a>
      /*<a name="wp929509"> </a>
      * Terminate access to the current raster image.<a name="wp929510"> </a>
      */<a name="wp929511"> </a>
      status = GRendaccess (ri_id);<a name="wp929512"> </a>
   }<a name="wp929513"> </a>
   /*<a name="wp929515"> </a>
   * Terminate access to the GR interface and close the HDF file.<a name="wp929516"> </a>
   */<a name="wp929517"> </a>
   status = GRend (gr_id);<a name="wp929518"> </a>
   status = Hclose (file_id);<a name="wp929519"> </a>
}<a name="wp929520"> </a>
</pre></div>
<a name="wp928571"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
image_info.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program image_info<a name="wp929530"> </a>
      implicit none<a name="wp929535"> </a>
C<a name="wp929536"> </a>
C     Parameter declaration<a name="wp929537"> </a>
C<a name="wp929538"> </a>
      character*19 FILE_NAME<a name="wp929539"> </a>
C<a name="wp929540"> </a>
      parameter (FILE_NAME = `General_RImages.hdf&#39;)<a name="wp929541"> </a>
      integer DFACC_READ<a name="wp929542"> </a>
      parameter (DFACC_READ = 1)<a name="wp929543"> </a>
C<a name="wp929544"> </a>
C     Function declaration<a name="wp929545"> </a>
C<a name="wp929546"> </a>
      integer hopen, hclose<a name="wp929547"> </a>
      integer mgstart, mgselct, mgfinfo, mggiinf, mgendac, mgend <a name="wp929548"> </a>
C<a name="wp929550"> </a>
C**** Variable declaration *******************************************<a name="wp929551"> </a>
C<a name="wp929552"> </a>
      integer status<a name="wp929553"> </a>
      integer file_id, gr_id, ri_id<a name="wp929554"> </a>
      integer n_rimages, n_file_attrs, ri_index<a name="wp929555"> </a>
      integer n_comps, interlace_mode, n_attrs, data_type<a name="wp929556"> </a>
      integer dim_sizes(2)<a name="wp929557"> </a>
      character*10 type_string<a name="wp929558"> </a>
      character*24 interlace_string<a name="wp929559"> </a>
      character*64 name<a name="wp929560"> </a>
C<a name="wp929561"> </a>
C**** End of variable declaration ************************************<a name="wp929562"> </a>
C<a name="wp929563"> </a>
C<a name="wp929564"> </a>
C     Open the HDF file for reading.<a name="wp929565"> </a>
C<a name="wp929566"> </a>
      file_id = hopen(FILE_NAME, DFACC_READ, 0)<a name="wp929567"> </a>
C<a name="wp929568"> </a>
C     Initialize the GR interface.<a name="wp929569"> </a>
C<a name="wp929570"> </a>
      gr_id = mgstart(file_id)<a name="wp929571"> </a>
C<a name="wp929572"> </a>
C     Determine the contents of the file.<a name="wp929573"> </a>
C<a name="wp929574"> </a>
      status = mgfinfo(gr_id, n_rimages, n_file_attrs)<a name="wp929575"> </a>
C<a name="wp929576"> </a>
C     For each image in the file, get and display image information.<a name="wp929577"> </a>
C<a name="wp929578"> </a>
      do 100 ri_index = 0, n_rimages-1<a name="wp929579"> </a>
         ri_id = mgselct(gr_id, ri_index)<a name="wp929580"> </a>
         status = mggiinf(ri_id, name, n_comps, data_type,<a name="wp929581"> </a>
     +                    interlace_mode, dim_sizes, n_attrs)<a name="wp929582"> </a>
C<a name="wp929583"> </a>
C     Map the number type and interlace mode into text strings for<a name="wp929584"> </a>
C     output readability.<a name="wp929585"> </a>
C<a name="wp929586"> </a>
      if(data_type .eq. 4) then<a name="wp929587"> </a>
         type_string = `DFNT_CHAR8&#39;<a name="wp929588"> </a>
      else if(data_type .eq. 22) then<a name="wp929589"> </a>
         type_string = `DFNT_INT16&#39;<a name="wp929590"> </a>
      else<a name="wp929591"> </a>
         type_string = `Unknown&#39;<a name="wp929592"> </a>
      endif<a name="wp929593"> </a>
      if (interlace_mode .eq. 0) then<a name="wp929594"> </a>
          interlace_string = `MFGR_INTERLACE_PIXEL&#39;<a name="wp929595"> </a>
      else if(interlace_mode .eq. 1) then<a name="wp929596"> </a>
          interlace_string = `MFGR_INTERLACE_LINE&#39;<a name="wp929597"> </a>
      else if(interlace_mode .eq. 2) then<a name="wp929598"> </a>
          interlace_string = `MFGR_INTERLACE_COMPONENT&#39;<a name="wp929599"> </a>
      else<a name="wp929600"> </a>
         interlace_string = `Unknown&#39;<a name="wp929601"> </a>
      endif<a name="wp929602"> </a>
C<a name="wp929603"> </a>
C     Display the image information for the current image.<a name="wp929604"> </a>
C<a name="wp929605"> </a>
      write(*,*) `Image index: `, ri_index<a name="wp929606"> </a>
      write(*,*) `Image name: `, name <a name="wp929607"> </a>
      write(*,*) `Number of components: `, n_comps<a name="wp929608"> </a>
      write(*,*) `Number type: `, type_string <a name="wp929609"> </a>
      write(*,*) `Interlace mode: `, interlace_string<a name="wp929610"> </a>
      write(*,*) `Dimnesions: `, dim_sizes(1), dim_sizes(2)<a name="wp929611"> </a>
      write(*,*) `Number of image attributes: `, n_attrs<a name="wp929612"> </a>
      write(*,*) <a name="wp929613"> </a>
C<a name="wp929614"> </a>
C     Terminate access to the current raster image.<a name="wp929615"> </a>
C<a name="wp929616"> </a>
      status = mgendac(ri_id)<a name="wp929617"> </a>
100   continue<a name="wp929618"> </a>
C<a name="wp929619"> </a>
C     Terminate access to the GR interface and close the HDF file.<a name="wp929620"> </a>
      status = mgend(gr_id)<a name="wp929621"> </a>
      status = hclose(file_id)<a name="wp929622"> </a>
      end<a name="wp929623"> </a>
</pre></div>
<a name="wp928573"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
set_attribute.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp929633"> </a>
#define  FILE_NAME          &quot;General_RImages.hdf&quot;<a name="wp929639"> </a>
#define  IMAGE_NAME         &quot;Image Array 2&quot;<a name="wp929640"> </a>
#define  F_ATT1_NAME        &quot;File Attribute 1&quot;<a name="wp929641"> </a>
#define  F_ATT2_NAME        &quot;File Attribute 2&quot;<a name="wp929642"> </a>
#define  RI_ATT1_NAME       &quot;Image Attribute 1&quot;<a name="wp929643"> </a>
#define  RI_ATT2_NAME       &quot;Image Attribute 2&quot;<a name="wp929644"> </a>
#define  F_ATT1_VAL         &quot;Contents of First FILE Attribute&quot;<a name="wp929645"> </a>
#define  F_ATT2_VAL         &quot;Contents of Second FILE Attribute&quot;<a name="wp929646"> </a>
#define  F_ATT1_N_VALUES    32<a name="wp929647"> </a>
#define  F_ATT2_N_VALUES    33<a name="wp929648"> </a>
#define  RI_ATT1_VAL        &quot;Contents of IMAGE&#39;s First Attribute&quot;<a name="wp929649"> </a>
#define  RI_ATT1_N_VALUES   35<a name="wp929650"> </a>
#define  RI_ATT2_N_VALUES   6<a name="wp929651"> </a>
main( ) <a name="wp929653"> </a>
{<a name="wp929654"> </a>
   /************************* Variable declaration **************************/<a name="wp929655"> </a>
   <a name="wp929656"> </a>
   intn  status;         /* status for functions returning an intn */<a name="wp929657"> </a>
   int32 gr_id, ri_id, file_id,<a name="wp929658"> </a>
         ri_index;<a name="wp929659"> </a>
   int16 ri_attr_2[RI_ATT2_N_VALUES] = {1, 2, 3, 4, 5, 6};<a name="wp929660"> </a>
   /********************** End of variable declaration **********************/<a name="wp929662"> </a>
   /*<a name="wp929664"> </a>
   * Open the HDF file.<a name="wp929665"> </a>
   */<a name="wp929666"> </a>
   file_id = Hopen (FILE_NAME, DFACC_WRITE, 0);<a name="wp929667"> </a>
   /*<a name="wp929669"> </a>
   * Initialize the GR interface.<a name="wp929670"> </a>
   */<a name="wp929671"> </a>
   gr_id = GRstart (file_id);<a name="wp929672"> </a>
   /*<a name="wp929674"> </a>
   * Set two file attributes to the file with names, data types, numbers of <a name="wp929675"> </a>
   * values, and values of the attributes specified.<a name="wp929676"> </a>
   */<a name="wp929677"> </a>
   status = GRsetattr (gr_id, F_ATT1_NAME, DFNT_CHAR8, F_ATT1_N_VALUES, <a name="wp929678"> </a>
                       (VOIDP)F_ATT1_VAL); <a name="wp929679"> </a>
   status = GRsetattr (gr_id, F_ATT2_NAME, DFNT_CHAR8, F_ATT2_N_VALUES, <a name="wp929681"> </a>
                       (VOIDP)F_ATT2_VAL);<a name="wp929682"> </a>
   /*<a name="wp929684"> </a>
   * Obtain the index of the image named IMAGE_NAME.<a name="wp929685"> </a>
   */<a name="wp929686"> </a>
   ri_index = GRnametoindex (gr_id, IMAGE_NAME);<a name="wp929687"> </a>
   /*<a name="wp929689"> </a>
   * Obtain the identifier of this image.<a name="wp929690"> </a>
   */<a name="wp929691"> </a>
   ri_id = GRselect (gr_id, ri_index);<a name="wp929692"> </a>
   /*<a name="wp929694"> </a>
   * Set two attributes to the image with names, data types, numbers of <a name="wp929695"> </a>
   * values, and values of the attributes specified.<a name="wp929696"> </a>
   */<a name="wp929697"> </a>
   status = GRsetattr (ri_id, RI_ATT1_NAME, DFNT_CHAR8, RI_ATT1_N_VALUES, <a name="wp929698"> </a>
                       (VOIDP)RI_ATT1_VAL);<a name="wp929699"> </a>
   status = GRsetattr (ri_id, RI_ATT2_NAME, DFNT_INT16, RI_ATT2_N_VALUES, <a name="wp929701"> </a>
                       (VOIDP)ri_attr_2);<a name="wp929702"> </a>
   /*<a name="wp929704"> </a>
   * Terminate access to the image and to the GR interface, and close the<a name="wp929705"> </a>
   * HDF file.<a name="wp929706"> </a>
   */<a name="wp929707"> </a>
   status = GRendaccess (ri_id);<a name="wp929708"> </a>
   status = GRend (gr_id);<a name="wp929709"> </a>
   status = Hclose (file_id);<a name="wp929710"> </a>
}<a name="wp929711"> </a>
</pre></div>
<a name="wp928575"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
set_attribute.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program  set_attribute<a name="wp929717"> </a>
      implicit none<a name="wp929722"> </a>
C<a name="wp929723"> </a>
C     Parameter declaration<a name="wp929724"> </a>
C<a name="wp929725"> </a>
      character*19 FILE_NAME<a name="wp929726"> </a>
      character*13 IMAGE_NAME<a name="wp929727"> </a>
      character*16 F_ATT1_NAME<a name="wp929728"> </a>
      character*16 F_ATT2_NAME<a name="wp929729"> </a>
      character*17 RI_ATT1_NAME<a name="wp929730"> </a>
      character*17 RI_ATT2_NAME<a name="wp929731"> </a>
      character*32 F_ATT1_VAL<a name="wp929732"> </a>
      character*33 F_ATT2_VAL<a name="wp929733"> </a>
      integer      F_ATT1_N_VALUES<a name="wp929734"> </a>
      integer      F_ATT2_N_VALUES<a name="wp929735"> </a>
      character*35 RI_ATT1_VAL<a name="wp929736"> </a>
      integer      RI_ATT1_N_VALUES<a name="wp929737"> </a>
      integer      RI_ATT2_N_VALUES<a name="wp929738"> </a>
C<a name="wp929739"> </a>
      parameter (FILE_NAME    = `General_RImages.hdf&#39;,<a name="wp929740"> </a>
     +           IMAGE_NAME   = `Image Array 2&#39;,<a name="wp929741"> </a>
     +           F_ATT1_NAME  = `File Attribute 1&#39;,<a name="wp929742"> </a>
     +           F_ATT2_NAME  = `File Attribute 2&#39;,<a name="wp929743"> </a>
     +           RI_ATT1_NAME = `Image Attribute 1&#39;,<a name="wp929744"> </a>
     +           RI_ATT2_NAME = `Image Attribute 2&#39;,<a name="wp929745"> </a>
     +           F_ATT1_VAL   = `Contents of First FILE Attribute&#39;,<a name="wp929746"> </a>
     +           F_ATT2_VAL   = `Contents of Second FILE Attribute&#39;,<a name="wp929747"> </a>
     +           F_ATT1_N_VALUES = 32,<a name="wp929748"> </a>
     +           F_ATT2_N_VALUES = 33,<a name="wp929749"> </a>
     +           RI_ATT1_VAL = `Contents of IMAGE&#39;&#39;s First Attribute&#39;,<a name="wp929750"> </a>
     +           RI_ATT1_N_VALUES = 35,<a name="wp929751"> </a>
     +           RI_ATT2_N_VALUES = 6)<a name="wp929752"> </a>
      integer DFACC_WRITE, DFNT_INT16, DFNT_CHAR8<a name="wp929753"> </a>
      parameter (DFACC_WRITE  = 2,<a name="wp929754"> </a>
     +           DFNT_CHAR8   = 4,<a name="wp929755"> </a>
     +           DFNT_INT16   = 22)<a name="wp929756"> </a>
C<a name="wp929757"> </a>
C     Function declaration<a name="wp929758"> </a>
C<a name="wp929759"> </a>
      integer hopen, hclose<a name="wp929760"> </a>
      integer mgstart, mgscatt, mgsnatt , mgn2ndx,<a name="wp929761"> </a>
     +        mgselct, mgendac, mgend <a name="wp929762"> </a>
C<a name="wp929764"> </a>
C**** Variable declaration *******************************************<a name="wp929765"> </a>
C<a name="wp929766"> </a>
      integer   status<a name="wp929767"> </a>
      integer   file_id, gr_id, ri_id, ri_index<a name="wp929768"> </a>
      integer*2 ri_attr_2(RI_ATT2_N_VALUES)<a name="wp929769"> </a>
      integer   i<a name="wp929770"> </a>
      do 10 i = 1, RI_ATT2_N_VALUES<a name="wp929772"> </a>
         ri_attr_2(i) = i<a name="wp929773"> </a>
10    continue <a name="wp929774"> </a>
C<a name="wp929775"> </a>
C**** End of variable declaration ************************************<a name="wp929776"> </a>
C<a name="wp929777"> </a>
C<a name="wp929778"> </a>
C     Open the HDF file.<a name="wp929779"> </a>
C<a name="wp929780"> </a>
      file_id = hopen(FILE_NAME, DFACC_WRITE, 0)<a name="wp929781"> </a>
C<a name="wp929782"> </a>
C     Initialize the GR interface.<a name="wp929783"> </a>
C<a name="wp929784"> </a>
      gr_id = mgstart(file_id)<a name="wp929785"> </a>
C<a name="wp929786"> </a>
C     Set two file attributes to the file with names, data type, numbers of<a name="wp929787"> </a>
C     values, and values of attributes specified.<a name="wp929788"> </a>
C<a name="wp929789"> </a>
      status = mgscatt(gr_id, F_ATT1_NAME, DFNT_CHAR8, <a name="wp929790"> </a>
     +                 F_ATT1_N_VALUES, F_ATT1_VAL)<a name="wp929791"> </a>
      status = mgscatt(gr_id, F_ATT2_NAME, DFNT_CHAR8, <a name="wp929792"> </a>
     +                 F_ATT2_N_VALUES, F_ATT2_VAL)<a name="wp929793"> </a>
C<a name="wp929794"> </a>
C     Obtain the index of the image named IMAGE_NAMR.<a name="wp929795"> </a>
C<a name="wp929796"> </a>
      ri_index = mgn2ndx(gr_id, IMAGE_NAME)<a name="wp929797"> </a>
C<a name="wp929798"> </a>
C     Obtain the identifier of this image. <a name="wp929799"> </a>
C<a name="wp929800"> </a>
      ri_id = mgselct(gr_id, ri_index)<a name="wp929801"> </a>
C<a name="wp929802"> </a>
C     Set two attributes of the image with names, data types, number of<a name="wp929803"> </a>
C     values, and values of the attributes specified. <a name="wp929804"> </a>
C<a name="wp929805"> </a>
      status = mgscatt(ri_id, RI_ATT1_NAME, DFNT_CHAR8, <a name="wp929806"> </a>
     +                 RI_ATT1_N_VALUES, RI_ATT1_VAL) <a name="wp929807"> </a>
      status = mgsnatt(ri_id, RI_ATT2_NAME, DFNT_INT16, <a name="wp929808"> </a>
     +                 RI_ATT2_N_VALUES, ri_attr_2)<a name="wp929809"> </a>
C<a name="wp929810"> </a>
C     Terminate access to the image and to the GR interface,<a name="wp929811"> </a>
C     and close the HDF file.<a name="wp929812"> </a>
C<a name="wp929813"> </a>
      status = mgendac(ri_id)<a name="wp929814"> </a>
      status = mgend(gr_id)<a name="wp929815"> </a>
      status = hclose(file_id)<a name="wp929816"> </a>
      end<a name="wp929817"> </a>
</pre></div>
<a name="wp928577"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
get_attribute.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp929827"> </a>
#define  FILE_NAME       &quot;General_RImages.hdf&quot;<a name="wp929833"> </a>
#define  RI_ATTR_NAME    &quot;Image Attribute 2&quot;<a name="wp929834"> </a>
main( ) <a name="wp929836"> </a>
{<a name="wp929837"> </a>
   /************************* Variable declaration **************************/<a name="wp929838"> </a>
   intn   status;          /* status for functions returning an intn */<a name="wp929840"> </a>
   int32  gr_id, ri_id, file_id,<a name="wp929841"> </a>
          f_att_index,     /* index of file attributes */<a name="wp929842"> </a>
          ri_att_index,    /* index of raster image attributes */<a name="wp929843"> </a>
          data_type,       /* image data type */<a name="wp929844"> </a>
          n_values,        /* number of values in an attribute */<a name="wp929845"> </a>
          value_index,     /* index of values in an attribute */<a name="wp929846"> </a>
          n_rimages,       /* number of raster images in the file */<a name="wp929847"> </a>
          n_file_attrs;    /* number of file attributes */<a name="wp929848"> </a>
   char   attr_name[MAX_GR_NAME];  /* buffer to hold the attribute name     */<a name="wp929849"> </a>
   VOIDP  data_buf;                /* buffer to hold the attribute values   */<a name="wp929850"> </a>
   int16 *int_ptr;      /* int16 pointer to point to a void data buffer     */<a name="wp929851"> </a>
   char8 *char_ptr;     /* char8 pointer to point to a void data buffer     */<a name="wp929852"> </a>
   /********************** End of variable declaration **********************/<a name="wp929854"> </a>
   /*<a name="wp929856"> </a>
   * Open the HDF file.<a name="wp929857"> </a>
   */<a name="wp929858"> </a>
   file_id = Hopen (FILE_NAME, DFACC_READ, 0);<a name="wp929859"> </a>
   /*<a name="wp929861"> </a>
   * Initialize the GR interface.<a name="wp929862"> </a>
   */<a name="wp929863"> </a>
   gr_id = GRstart (file_id);<a name="wp929864"> </a>
   /*<a name="wp929866"> </a>
   * Determine the number of attributes in the file.<a name="wp929867"> </a>
   */<a name="wp929868"> </a>
   status = GRfileinfo (gr_id, &amp;n_rimages, &amp;n_file_attrs);<a name="wp929869"> </a>
   if (status != FAIL &amp;&amp; n_file_attrs &gt; 0)<a name="wp929871"> </a>
   {<a name="wp929872"> </a>
      for (f_att_index = 0; f_att_index &lt; n_file_attrs; f_att_index++)<a name="wp929873"> </a>
      {<a name="wp929874"> </a>
         /*<a name="wp929875"> </a>
         * Get information about the current file attribute.<a name="wp929876"> </a>
         */<a name="wp929877"> </a>
         status = GRattrinfo (gr_id, f_att_index, attr_name, &amp;data_type, <a name="wp929878"> </a>
                              &amp;n_values);<a name="wp929879"> </a>
         /*<a name="wp929881"> </a>
         * Allocate a buffer to hold the file attribute data.  In this example,<a name="wp929882"> </a>
         * knowledge about the data type is assumed to be available from <a name="wp929883"> </a>
         * the previous example for simplicity.  In reality, the size<a name="wp929884"> </a>
         * of the type must be determined based on the machine where the <a name="wp929885"> </a>
         * program resides.<a name="wp929886"> </a>
         */<a name="wp929887"> </a>
         if (data_type == DFNT_CHAR8)<a name="wp929888"> </a>
         {<a name="wp929889"> </a>
            data_buf = malloc (n_values * sizeof (char8));<a name="wp929890"> </a>
            if (data_buf == NULL)<a name="wp929891"> </a>
            {<a name="wp929892"> </a>
               printf (&quot;Unable to allocate space for attribute data.\n&quot;);<a name="wp929893"> </a>
               exit (1);<a name="wp929894"> </a>
            }<a name="wp929895"> </a>
         }<a name="wp929896"> </a>
         else<a name="wp929897"> </a>
         {<a name="wp929898"> </a>
            printf (&quot;Unable to determine data type to allocate data buffer.\n&quot;);<a name="wp929899"> </a>
            exit (1);<a name="wp929900"> </a>
         }<a name="wp929901"> </a>
         /*<a name="wp929903"> </a>
         * Read and display the attribute values.<a name="wp929904"> </a>
         */<a name="wp929905"> </a>
         status = GRgetattr (gr_id, f_att_index, (VOIDP)data_buf);<a name="wp929906"> </a>
         char_ptr = (char8 *) data_buf;<a name="wp929907"> </a>
         printf (&quot;Attribute %s: &quot;, attr_name);<a name="wp929908"> </a>
         for (value_index = 0; value_index &lt; n_values; value_index++)<a name="wp929909"> </a>
            printf (&quot;%c&quot;, char_ptr[value_index]);<a name="wp929910"> </a>
         printf (&quot;\n&quot;);<a name="wp929911"> </a>
         /*<a name="wp929913"> </a>
         * Free the space allocated for the data buffer.<a name="wp929914"> </a>
         */<a name="wp929915"> </a>
         free (data_buf);<a name="wp929916"> </a>
      } /* for */<a name="wp929917"> </a>
   } /* if */<a name="wp929918"> </a>
   /*<a name="wp929920"> </a>
   * Select the second image in the file.<a name="wp929921"> </a>
   */<a name="wp929922"> </a>
   ri_id = GRselect (gr_id, 1);<a name="wp929923"> </a>
   /*<a name="wp929925"> </a>
   * Find the image attribute named RI_ATTR_NAME.<a name="wp929926"> </a>
   */<a name="wp929927"> </a>
   ri_att_index = GRfindattr (ri_id, RI_ATTR_NAME);<a name="wp929928"> </a>
   /*<a name="wp929930"> </a>
   * Get information about the attribute.<a name="wp929931"> </a>
   */<a name="wp929932"> </a>
   status = GRattrinfo (ri_id, ri_att_index, attr_name, &amp;data_type, &amp;n_values);<a name="wp929933"> </a>
   /*<a name="wp929935"> </a>
   * Allocate a buffer to hold the file attribute data.  As mentioned above,<a name="wp929936"> </a>
   * knowledge about the data type is assumed to be available from<a name="wp929937"> </a>
   * the previous example for simplicity.  In reality, the size of the <a name="wp929938"> </a>
   * type must be determined based on the machine where the program resides.<a name="wp929939"> </a>
   */<a name="wp929940"> </a>
   if (data_type == DFNT_INT16)<a name="wp929941"> </a>
      data_buf = malloc (n_values * sizeof (int16));<a name="wp929942"> </a>
   /*<a name="wp929944"> </a>
   * Read and display the attribute values.<a name="wp929945"> </a>
   */<a name="wp929946"> </a>
   status = GRgetattr (ri_id, ri_att_index, (VOIDP)data_buf);<a name="wp929947"> </a>
   printf (&quot;\nAttribute %s: &quot;, RI_ATTR_NAME);<a name="wp929948"> </a>
   int_ptr = (int16 *)data_buf;<a name="wp929949"> </a>
   for (value_index = 0; value_index &lt; n_values; value_index++)<a name="wp929950"> </a>
      printf (&quot;%d &quot;, int_ptr[value_index]);<a name="wp929951"> </a>
   printf (&quot;\n&quot;);<a name="wp929952"> </a>
   /*<a name="wp929954"> </a>
   * Free the space allocated for the data buffer.<a name="wp929955"> </a>
   */<a name="wp929956"> </a>
   free (data_buf);<a name="wp929957"> </a>
   /*<a name="wp929959"> </a>
   * Terminate access to the raster image and to the GR interface, and<a name="wp929960"> </a>
   * close the file.<a name="wp929961"> </a>
   */<a name="wp929962"> </a>
   status = GRendaccess (ri_id);<a name="wp929963"> </a>
   status = GRend (gr_id);<a name="wp929964"> </a>
   status = Hclose (file_id);<a name="wp929965"> </a>
}<a name="wp929966"> </a>
</pre></div>
<a name="wp928579"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
get_attribute.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program  get_attribute<a name="wp929980"> </a>
      implicit none<a name="wp929985"> </a>
C<a name="wp929986"> </a>
C     Parameter declaration<a name="wp929987"> </a>
C<a name="wp929988"> </a>
      character*19 FILE_NAME<a name="wp929989"> </a>
      character*17 RI_ATTR_NAME<a name="wp929990"> </a>
C<a name="wp929991"> </a>
      parameter (FILE_NAME    = `General_RImages.hdf&#39;,<a name="wp929992"> </a>
     +           RI_ATTR_NAME  = `Image Attribute 2&#39;)<a name="wp929993"> </a>
      integer DFACC_READ, DFNT_INT16, DFNT_CHAR8<a name="wp929994"> </a>
      parameter (DFACC_READ   = 1,<a name="wp929995"> </a>
     +           DFNT_CHAR8   = 4,<a name="wp929996"> </a>
     +           DFNT_INT16   = 22)<a name="wp929997"> </a>
C<a name="wp929998"> </a>
C     Function declaration<a name="wp929999"> </a>
C<a name="wp930000"> </a>
      integer hopen, hclose<a name="wp930001"> </a>
      integer mgstart, mgfinfo, mgatinf, mggcatt, mggnatt , mgfndat,<a name="wp930002"> </a>
     +        mgselct, mgendac, mgend <a name="wp930003"> </a>
C<a name="wp930005"> </a>
C**** Variable declaration *******************************************<a name="wp930006"> </a>
C<a name="wp930007"> </a>
      integer      status<a name="wp930008"> </a>
      integer      file_id, gr_id, ri_id<a name="wp930009"> </a>
      integer      f_att_index, ri_att_index, data_type, n_values <a name="wp930010"> </a>
      integer      n_rimages, n_file_attrs <a name="wp930011"> </a>
      integer*2    int_buf(10)<a name="wp930012"> </a>
      character*17 attr_name<a name="wp930013"> </a>
      character*80 char_buf<a name="wp930014"> </a>
      integer      i<a name="wp930015"> </a>
C<a name="wp930016"> </a>
C**** End of variable declaration ************************************<a name="wp930017"> </a>
C<a name="wp930018"> </a>
C<a name="wp930019"> </a>
C     Open the HDF file.<a name="wp930020"> </a>
C<a name="wp930021"> </a>
      file_id = hopen(FILE_NAME, DFACC_READ, 0)<a name="wp930022"> </a>
C<a name="wp930023"> </a>
C     Initialize the GR interface.<a name="wp930024"> </a>
C<a name="wp930025"> </a>
      gr_id = mgstart(file_id)<a name="wp930026"> </a>
C<a name="wp930027"> </a>
C     Determine the number of attributes in the file. <a name="wp930028"> </a>
C<a name="wp930029"> </a>
      status = mgfinfo(gr_id, n_rimages, n_file_attrs)<a name="wp930030"> </a>
      if ((status .NE. -1) .AND. (n_file_attrs .GT. 0)) then<a name="wp930031"> </a>
         do 10 f_att_index = 0, n_file_attrs-1<a name="wp930033"> </a>
C<a name="wp930034"> </a>
C        Get information about the current file attribute.<a name="wp930035"> </a>
C <a name="wp930036"> </a>
         status = mgatinf(gr_id, f_att_index, attr_name, data_type,<a name="wp930037"> </a>
     +                    n_values)<a name="wp930038"> </a>
C<a name="wp930039"> </a>
C        Check whether data type is DFNT_CHAR8 in order to use allocated buffer.<a name="wp930040"> </a>
C<a name="wp930041"> </a>
         if(data_type .NE. DFNT_CHAR8) then<a name="wp930042"> </a>
            write(*,*) <a name="wp930043"> </a>
     +      `Unable to determine data type to use allocated buffer&#39;<a name="wp930044"> </a>
         else<a name="wp930045"> </a>
C<a name="wp930046"> </a>
C           Read and display the attribute values.<a name="wp930047"> </a>
C<a name="wp930048"> </a>
            status = mggcatt(gr_id, f_att_index, char_buf)<a name="wp930049"> </a>
            write(*,*) `Attribute `, attr_name, ` : `, <a name="wp930050"> </a>
     +                 char_buf(1:n_values)<a name="wp930051"> </a>
         endif<a name="wp930052"> </a>
10       continue<a name="wp930053"> </a>
      endif<a name="wp930055"> </a>
C<a name="wp930057"> </a>
C     Select the second image in the file.<a name="wp930058"> </a>
C <a name="wp930059"> </a>
      ri_id = mgselct(gr_id, 1) <a name="wp930060"> </a>
C<a name="wp930061"> </a>
C     Find the image attribute named RI_ATTR_NAME. <a name="wp930062"> </a>
C<a name="wp930063"> </a>
      ri_att_index = mgfndat(ri_id, RI_ATTR_NAME)<a name="wp930064"> </a>
C<a name="wp930065"> </a>
C     Get information about the attribute.<a name="wp930066"> </a>
C<a name="wp930067"> </a>
      status = mgatinf(ri_id, ri_att_index, attr_name, data_type,<a name="wp930068"> </a>
     +                 n_values)<a name="wp930069"> </a>
C      <a name="wp930070"> </a>
C     Read and display attribute values.<a name="wp930071"> </a>
C<a name="wp930072"> </a>
      status = mggnatt(ri_id, ri_att_index, int_buf)<a name="wp930073"> </a>
      write(*,*) `Attributes :&#39;, (int_buf(i), i = 1, n_values)<a name="wp930074"> </a>
C<a name="wp930075"> </a>
C     Terminate access to the image and to the GR interface,<a name="wp930076"> </a>
C     and close the HDF file.<a name="wp930077"> </a>
C<a name="wp930078"> </a>
      status = mgendac(ri_id)<a name="wp930079"> </a>
      status = mgend(gr_id)<a name="wp930080"> </a>
      status = hclose(file_id)<a name="wp930081"> </a>
      end<a name="wp930082"> </a>
</pre></div>
<a name="wp928581"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
write_palette.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp930088"> </a>
#define  FILE_NAME         &quot;Image_with_Palette.hdf&quot;<a name="wp930094"> </a>
#define  NEW_IMAGE_NAME    &quot;Image with Palette&quot;<a name="wp930095"> </a>
#define  N_COMPS_IMG       2       /* number of image components */<a name="wp930096"> </a>
#define  X_LENGTH          5<a name="wp930097"> </a>
#define  Y_LENGTH          5<a name="wp930098"> </a>
#define  N_ENTRIES         256     /* number of entries in the palette */<a name="wp930099"> </a>
#define  N_COMPS_PAL       3       /* number of palette&#39;s components */<a name="wp930100"> </a>
main( )<a name="wp930102"> </a>
{<a name="wp930103"> </a>
   /************************* Variable declaration **************************/<a name="wp930104"> </a>
   intn  status,         /* status for functions returning an intn */<a name="wp930106"> </a>
         i, j;<a name="wp930107"> </a>
   int32 file_id, gr_id, ri_id, pal_id, <a name="wp930108"> </a>
         interlace_mode, <a name="wp930109"> </a>
         start[2],     /* holds where to start to write for each dimension  */<a name="wp930110"> </a>
         edges[2],     /* holds how long to write for each dimension */<a name="wp930111"> </a>
         dim_sizes[2];  /* sizes of the two dimensions of the image array   */<a name="wp930112"> </a>
   uint8 image_buf[Y_LENGTH][X_LENGTH][N_COMPS_IMG]; /* data of first image */<a name="wp930113"> </a>
   uint8 palette_buf[N_ENTRIES][N_COMPS_PAL];<a name="wp930114"> </a>
   /********************** End of variable declaration **********************/<a name="wp930116"> </a>
   /* <a name="wp930118"> </a>
   * Open the HDF file.<a name="wp930119"> </a>
   */<a name="wp930120"> </a>
   file_id = Hopen (FILE_NAME, DFACC_CREATE, 0);<a name="wp930121"> </a>
   /* <a name="wp930123"> </a>
   * Initialize the GR interface.<a name="wp930124"> </a>
   */<a name="wp930125"> </a>
   gr_id = GRstart (file_id);<a name="wp930126"> </a>
   /* <a name="wp930128"> </a>
   * Define the dimensions and interlace mode of the image. <a name="wp930129"> </a>
   */<a name="wp930130"> </a>
   dim_sizes[0] = X_LENGTH;<a name="wp930131"> </a>
   dim_sizes[1] = Y_LENGTH;<a name="wp930132"> </a>
   interlace_mode = MFGR_INTERLACE_PIXEL;<a name="wp930133"> </a>
   /* <a name="wp930135"> </a>
   * Create the image named NEW_IMAGE_NAME.<a name="wp930136"> </a>
   */<a name="wp930137"> </a>
   ri_id = GRcreate (gr_id, NEW_IMAGE_NAME, N_COMPS_IMG, DFNT_UINT8, <a name="wp930138"> </a>
                     interlace_mode, dim_sizes);<a name="wp930139"> </a>
   /*<a name="wp930141"> </a>
   * Fill the image data buffer with values.<a name="wp930142"> </a>
   */<a name="wp930143"> </a>
   for (i = 0; i &lt; Y_LENGTH; i++)<a name="wp930144"> </a>
   {<a name="wp930145"> </a>
      for (j = 0; j &lt; X_LENGTH; j++)<a name="wp930146"> </a>
      {<a name="wp930147"> </a>
         image_buf[i][j][0] = (i + j) + 1;<a name="wp930148"> </a>
         image_buf[i][j][1] = (i + j) + 2;<a name="wp930149"> </a>
      }<a name="wp930150"> </a>
    }<a name="wp930151"> </a>
   /*<a name="wp930153"> </a>
   * Define the size of the data to be written, i.e., start from the origin<a name="wp930154"> </a>
   * and go as long as the length of each dimension.<a name="wp930155"> </a>
   */<a name="wp930156"> </a>
   start[0] = start[1] = 0;<a name="wp930157"> </a>
   edges[0] = X_LENGTH;<a name="wp930158"> </a>
   edges[1] = Y_LENGTH;<a name="wp930159"> </a>
   /*<a name="wp930161"> </a>
   * Write the data in the buffer into the image array.<a name="wp930162"> </a>
   */<a name="wp930163"> </a>
   status = GRwriteimage (ri_id, start, NULL, edges, (VOIDP)image_buf);<a name="wp930164"> </a>
   /* <a name="wp930166"> </a>
   * Initialize the palette to grayscale. <a name="wp930167"> </a>
   */<a name="wp930168"> </a>
   for (i = 0; i &lt; N_ENTRIES; i++) {<a name="wp930169"> </a>
      palette_buf[i][0] = i;<a name="wp930170"> </a>
      palette_buf[i][1] = i;<a name="wp930171"> </a>
      palette_buf[i][2] = i;<a name="wp930172"> </a>
   }<a name="wp930173"> </a>
   /*<a name="wp930175"> </a>
   * Define palette interlace mode.<a name="wp930176"> </a>
   */<a name="wp930177"> </a>
   interlace_mode = MFGR_INTERLACE_PIXEL;<a name="wp930178"> </a>
   /* <a name="wp930180"> </a>
   * Get the identifier of the palette attached to the image NEW_IMAGE_NAME.<a name="wp930181"> </a>
   */<a name="wp930182"> </a>
   pal_id = GRgetlutid (ri_id, 0);<a name="wp930183"> </a>
   /*<a name="wp930185"> </a>
   * Write data to the palette.<a name="wp930186"> </a>
   */<a name="wp930187"> </a>
   status = GRwritelut (pal_id, N_COMPS_PAL, DFNT_UINT8, interlace_mode,<a name="wp930188"> </a>
                        N_ENTRIES, (VOIDP)palette_buf);<a name="wp930189"> </a>
   /* <a name="wp930191"> </a>
   * Terminate access to the image and to the GR interface, and <a name="wp930192"> </a>
   * close the HDF file. <a name="wp930193"> </a>
   */<a name="wp930194"> </a>
   status = GRendaccess (ri_id);<a name="wp930195"> </a>
   status = GRend (gr_id);<a name="wp930196"> </a>
   status = Hclose (file_id);<a name="wp930197"> </a>
}<a name="wp930198"> </a>
</pre></div>
<a name="wp928590"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
write_palette.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program  write_palette<a name="wp930208"> </a>
      implicit none<a name="wp930213"> </a>
C<a name="wp930214"> </a>
C     Parameter declaration<a name="wp930215"> </a>
C<a name="wp930216"> </a>
      character*22 FILE_NAME<a name="wp930217"> </a>
      character*18 NEW_IMAGE_NAME<a name="wp930218"> </a>
      integer      X_LENGTH<a name="wp930219"> </a>
      integer      Y_LENGTH<a name="wp930220"> </a>
      integer      N_ENTRIES<a name="wp930221"> </a>
      integer      N_COMPS_IMG<a name="wp930222"> </a>
      integer      N_COMPS_PAL<a name="wp930223"> </a>
C<a name="wp930224"> </a>
      parameter (FILE_NAME       = `Image_with_Palette.hdf&#39;,<a name="wp930225"> </a>
     +           NEW_IMAGE_NAME  = `Image with Palette&#39;,<a name="wp930226"> </a>
     +           X_LENGTH        = 5,<a name="wp930227"> </a>
     +           Y_LENGTH        = 5,<a name="wp930228"> </a>
     +           N_ENTRIES       = 256,<a name="wp930229"> </a>
     +           N_COMPS_IMG     = 2,<a name="wp930230"> </a>
     +           N_COMPS_PAL     = 3)<a name="wp930231"> </a>
      integer DFACC_CREATE, DFNT_CHAR8, DFNT_UINT8, MFGR_INTERLACE_PIXEL<a name="wp930232"> </a>
      parameter (DFACC_CREATE = 4,<a name="wp930233"> </a>
     +           DFNT_CHAR8   = 4,<a name="wp930234"> </a>
     +           DFNT_UINT8   = 21,<a name="wp930235"> </a>
     +           MFGR_INTERLACE_PIXEL = 0)<a name="wp930236"> </a>
C<a name="wp930237"> </a>
C     Function declaration<a name="wp930238"> </a>
C<a name="wp930239"> </a>
      integer hopen, hclose<a name="wp930240"> </a>
      integer mgstart, mgcreat, mgwcimg, mggltid, mgwclut, <a name="wp930241"> </a>
     +        mgendac, mgend <a name="wp930242"> </a>
C<a name="wp930243"> </a>
C**** Variable declaration *******************************************<a name="wp930244"> </a>
C<a name="wp930245"> </a>
      integer    file_id, gr_id, ri_id, pal_id<a name="wp930246"> </a>
      integer    interlace_mode<a name="wp930247"> </a>
      integer    start(2), stride(2), edges(2), dim_sizes(2)<a name="wp930248"> </a>
      integer    status<a name="wp930249"> </a>
      integer    i, j<a name="wp930250"> </a>
      character  image_buf(N_COMPS_IMG, X_LENGTH, Y_LENGTH) <a name="wp930251"> </a>
      character  palette_buf(N_COMPS_PAL, N_ENTRIES)<a name="wp930252"> </a>
C<a name="wp930253"> </a>
C**** End of variable declaration ************************************<a name="wp930254"> </a>
C<a name="wp930255"> </a>
C<a name="wp930256"> </a>
C     Create and open the file.<a name="wp930257"> </a>
C<a name="wp930258"> </a>
      file_id = hopen(FILE_NAME, DFACC_CREATE, 0)<a name="wp930259"> </a>
C<a name="wp930260"> </a>
C     Initialize the GR interface.<a name="wp930261"> </a>
C<a name="wp930262"> </a>
      gr_id = mgstart(file_id)<a name="wp930263"> </a>
C<a name="wp930264"> </a>
C     Define interlace mode and dimensions of the image.  <a name="wp930265"> </a>
C<a name="wp930266"> </a>
      interlace_mode = MFGR_INTERLACE_PIXEL<a name="wp930267"> </a>
      dim_sizes(1) = X_LENGTH<a name="wp930268"> </a>
      dim_sizes(2) = Y_lENGTH<a name="wp930269"> </a>
C<a name="wp930270"> </a>
C     Create the raster image array. <a name="wp930271"> </a>
C<a name="wp930272"> </a>
      ri_id = mgcreat(gr_id, NEW_IMAGE_NAME, N_COMPS_IMG, DFNT_CHAR8,<a name="wp930273"> </a>
     +                interlace_mode, dim_sizes)<a name="wp930274"> </a>
C<a name="wp930275"> </a>
C     Fill the image data buffer with values. <a name="wp930276"> </a>
C<a name="wp930277"> </a>
      do 20 i = 1, Y_LENGTH<a name="wp930278"> </a>
         do 10 j = 1, X_LENGTH<a name="wp930279"> </a>
               image_buf(1,j,i) = char(i + j - 1 )<a name="wp930280"> </a>
               image_buf(2,j,i) = char(i + j) <a name="wp930281"> </a>
10       continue<a name="wp930282"> </a>
20    continue<a name="wp930283"> </a>
C     <a name="wp930285"> </a>
C     Define the size of the data to be written, i.e., start from the origin<a name="wp930286"> </a>
C     and go as long as the length of each dimension.<a name="wp930287"> </a>
C<a name="wp930288"> </a>
      start(1) = 0<a name="wp930289"> </a>
      start(2) = 0<a name="wp930290"> </a>
      edges(1) = X_LENGTH<a name="wp930291"> </a>
      edges(2) = Y_LENGTH<a name="wp930292"> </a>
      stride(1) = 1<a name="wp930293"> </a>
      stride(2) = 1<a name="wp930294"> </a>
C<a name="wp930295"> </a>
C     Write the data in the buffer into the image array.<a name="wp930296"> </a>
C<a name="wp930297"> </a>
      status = mgwcimg(ri_id, start, stride, edges, image_buf)<a name="wp930298"> </a>
C<a name="wp930299"> </a>
C     Initilaize the palette buffer to grayscale.<a name="wp930300"> </a>
C<a name="wp930301"> </a>
      do 40 i = 1, N_ENTRIES<a name="wp930302"> </a>
          do 30 j = 1, N_COMPS_PAL<a name="wp930303"> </a>
             palette_buf(j,i) = char(i)<a name="wp930304"> </a>
30        continue<a name="wp930305"> </a>
40    continue <a name="wp930306"> </a>
C<a name="wp930307"> </a>
C     Get the identifier of the palette attached to the image NEW_IMAGE_NAME.<a name="wp930308"> </a>
C<a name="wp930309"> </a>
      pal_id = mggltid(ri_id, 0)<a name="wp930310"> </a>
C<a name="wp930311"> </a>
C     Set palette interlace mode.<a name="wp930312"> </a>
C<a name="wp930313"> </a>
      interlace_mode = MFGR_INTERLACE_PIXEL<a name="wp930314"> </a>
C<a name="wp930315"> </a>
C     Write data to the palette.<a name="wp930316"> </a>
C<a name="wp930317"> </a>
      status = mgwclut(pal_id, N_COMPS_PAL, DFNT_UINT8, interlace_mode,<a name="wp930318"> </a>
     +                 N_ENTRIES, palette_buf)<a name="wp930319"> </a>
C<a name="wp930320"> </a>
C     Terminate access to the raster image and to the GR interface,<a name="wp930321"> </a>
C     and close the HDF file.<a name="wp930322"> </a>
C<a name="wp930323"> </a>
      status = mgendac(ri_id)<a name="wp930324"> </a>
      status = mgend(gr_id)<a name="wp930325"> </a>
      status = hclose(file_id)<a name="wp930326"> </a>
      end<a name="wp930327"> </a>
</pre></div>
<a name="wp928592"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
read_palette.c
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
#include &quot;hdf.h&quot;<a name="wp930341"> </a>
#define  FILE_NAME      &quot;Image_with_Palette.hdf&quot;<a name="wp930347"> </a>
#define  IMAGE_NAME     &quot;Image with Palette&quot;<a name="wp930348"> </a>
#define  N_ENTRIES      256     /* number of elements of each color */<a name="wp930349"> </a>
main( )<a name="wp930351"> </a>
{<a name="wp930352"> </a>
   /************************* Variable declaration **************************/<a name="wp930353"> </a>
   intn  status,         /* status for functions returning an intn */<a name="wp930355"> </a>
         i, j;<a name="wp930356"> </a>
   int32 file_id, gr_id, ri_id, pal_id, ri_index;<a name="wp930357"> </a>
   int32 data_type, n_comps, n_entries, interlace_mode; <a name="wp930358"> </a>
   uint8 palette_data[N_ENTRIES][3];        /* static because of fixed size */<a name="wp930359"> </a>
   /************************* Variable declaration **************************/<a name="wp930361"> </a>
   /* <a name="wp930363"> </a>
   * Open the file. <a name="wp930364"> </a>
   */<a name="wp930365"> </a>
   file_id = Hopen (FILE_NAME, DFACC_READ, 0);<a name="wp930366"> </a>
   /* <a name="wp930368"> </a>
   * Initiate the GR interface. <a name="wp930369"> </a>
   */<a name="wp930370"> </a>
   gr_id = GRstart (file_id);<a name="wp930371"> </a>
   /* <a name="wp930373"> </a>
   * Get the index of the image IMAGR_NAME.<a name="wp930374"> </a>
   */<a name="wp930375"> </a>
   ri_index = GRnametoindex (gr_id, IMAGE_NAME);<a name="wp930376"> </a>
   /*<a name="wp930378"> </a>
   * Get image identifier.<a name="wp930379"> </a>
   */<a name="wp930380"> </a>
   ri_id = GRselect (gr_id, ri_index);<a name="wp930381"> </a>
 <a name="wp930382"> </a>
   /* <a name="wp930383"> </a>
   * Get the identifier of the palette attached to the image. <a name="wp930384"> </a>
   */<a name="wp930385"> </a>
   pal_id = GRgetlutid (ri_id, ri_index);<a name="wp930386"> </a>
   /*<a name="wp930388"> </a>
   * Obtain and display information about the palette.<a name="wp930389"> </a>
   */<a name="wp930390"> </a>
   status = GRgetlutinfo (pal_id, &amp;n_comps, &amp;data_type, &amp;interlace_mode, <a name="wp930391"> </a>
                          &amp;n_entries);<a name="wp930392"> </a>
   printf (&quot;Palette: %d components; %d entries\n&quot;, n_comps, n_entries); <a name="wp930393"> </a>
   /* <a name="wp930395"> </a>
   * Read the palette data. <a name="wp930396"> </a>
   */<a name="wp930397"> </a>
   status = GRreadlut (pal_id, (VOIDP)palette_data);<a name="wp930398"> </a>
   /*<a name="wp930400"> </a>
   * Display the palette data.  Recall that HDF supports only 256 colors.<a name="wp930401"> </a>
   * Each color is defined by its 3 components. Therefore, <a name="wp930402"> </a>
   * verifying the value of n_entries and n_comps is not necessary and <a name="wp930403"> </a>
   * the buffer to hold the palette data can be static.  However, <a name="wp930404"> </a>
   * if more values or colors are added to the model, these parameters <a name="wp930405"> </a>
   * must be checked to allocate sufficient space when reading a palette.<a name="wp930406"> </a>
   */<a name="wp930407"> </a>
   printf (&quot;  Palette Data: \n&quot;);<a name="wp930408"> </a>
   for (i=0; i&lt; n_entries; i++)<a name="wp930409"> </a>
   {<a name="wp930410"> </a>
      for (j = 0; j &lt; n_comps; j++)<a name="wp930411"> </a>
         printf (&quot;%i &quot;, palette_data[i][j]);<a name="wp930412"> </a>
      printf (&quot;\n&quot;);<a name="wp930413"> </a>
   }<a name="wp930414"> </a>
   printf (&quot;\n&quot;);<a name="wp930415"> </a>
   /* <a name="wp930417"> </a>
   * Terminate access to the image and to the GR interface, and <a name="wp930418"> </a>
   * close the HDF file. <a name="wp930419"> </a>
   */<a name="wp930420"> </a>
   status = GRendaccess (ri_id);<a name="wp930421"> </a>
   status = GRend (gr_id);<a name="wp930422"> </a>
   status = Hclose (file_id);<a name="wp930423"> </a>
}<a name="wp930424"> </a>
</pre></div>
<a name="wp928594"> </a><div style="color: #000000; font-family: Times New Roman; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 6pt; margin-left: 0pt; margin-right: 0pt; margin-top: 12pt; text-align: left; text-decoration: underline; text-indent: 0pt; text-transform: none">
read_palette.f
</div>
<div class="pPreformatted" style="font-family: Arial; font-size: 10pt"><pre class="pPreformatted" style="font-family: Arial; font-size: 10pt">
      program  read_palette<a name="wp930430"> </a>
      implicit none<a name="wp930435"> </a>
C<a name="wp930436"> </a>
C     Parameter declaration<a name="wp930437"> </a>
C<a name="wp930438"> </a>
      character*22 FILE_NAME<a name="wp930439"> </a>
      character*18 IMAGE_NAME<a name="wp930440"> </a>
      integer      N_ENTRIES<a name="wp930441"> </a>
      integer      N_COMPS_PAL<a name="wp930442"> </a>
C<a name="wp930443"> </a>
      parameter (FILE_NAME   = `Image_with_Palette.hdf&#39;,<a name="wp930444"> </a>
     +           IMAGE_NAME  = `Image with Palette&#39;,<a name="wp930445"> </a>
     +           N_COMPS_PAL = 3,<a name="wp930446"> </a>
     +           N_ENTRIES   = 256)<a name="wp930447"> </a>
      integer DFACC_READ, DFNT_CHAR8, DFNT_UINT8, MFGR_INTERLACE_PIXEL<a name="wp930448"> </a>
      parameter (DFACC_READ  = 1,<a name="wp930449"> </a>
     +           DFNT_CHAR8  = 4,<a name="wp930450"> </a>
     +           DFNT_UINT8  = 21,<a name="wp930451"> </a>
     +           MFGR_INTERLACE_PIXEL = 0)<a name="wp930452"> </a>
C<a name="wp930453"> </a>
C     Function declaration<a name="wp930454"> </a>
C<a name="wp930455"> </a>
      integer hopen, hclose<a name="wp930456"> </a>
      integer mgstart, mgn2ndx, mgselct, mggltid, mgglinf, <a name="wp930457"> </a>
     +        mgrclut, mgendac, mgend <a name="wp930458"> </a>
C<a name="wp930459"> </a>
C**** Variable declaration *******************************************<a name="wp930460"> </a>
C<a name="wp930461"> </a>
      integer    file_id, gr_id, ri_id, ri_index, pal_id, pal_index<a name="wp930462"> </a>
      integer    interlace_mode<a name="wp930463"> </a>
      integer    data_type, n_comps, n_entries_out<a name="wp930464"> </a>
      integer    status<a name="wp930465"> </a>
      integer    i, j<a name="wp930466"> </a>
      character  palette_data(N_COMPS_PAL, N_ENTRIES)<a name="wp930467"> </a>
C<a name="wp930468"> </a>
C**** End of variable declaration ************************************<a name="wp930469"> </a>
C<a name="wp930470"> </a>
C<a name="wp930471"> </a>
C     Open the file.<a name="wp930472"> </a>
C<a name="wp930473"> </a>
      file_id = hopen(FILE_NAME, DFACC_READ, 0)<a name="wp930474"> </a>
C<a name="wp930475"> </a>
C     Initialize the GR interface.<a name="wp930476"> </a>
C<a name="wp930477"> </a>
      gr_id = mgstart(file_id)<a name="wp930478"> </a>
C<a name="wp930479"> </a>
C     Get the index of the image IMAGE_NAME.<a name="wp930480"> </a>
C<a name="wp930481"> </a>
      ri_index = mgn2ndx(gr_id, IMAGE_NAME)<a name="wp930482"> </a>
C<a name="wp930483"> </a>
C     Get the image identifier.<a name="wp930484"> </a>
C<a name="wp930485"> </a>
      ri_id = mgselct(gr_id, 0)<a name="wp930486"> </a>
C<a name="wp930487"> </a>
C     Get the identifier of the palette attached to the image.<a name="wp930488"> </a>
C<a name="wp930489"> </a>
      pal_index = 0<a name="wp930490"> </a>
      pal_id = mggltid(ri_id, pal_index)<a name="wp930491"> </a>
C<a name="wp930492"> </a>
C     Obtain information about the palette.<a name="wp930493"> </a>
C<a name="wp930494"> </a>
      status = mgglinf(pal_id, n_comps, data_type, interlace_mode,<a name="wp930495"> </a>
     +                 n_entries_out)<a name="wp930496"> </a>
      write(*,*) ` Palette: `, n_comps, ` components;  `, <a name="wp930497"> </a>
     +           n_entries_out, ` entries&#39;<a name="wp930498"> </a>
C<a name="wp930499"> </a>
C     Read the palette.<a name="wp930500"> </a>
C<a name="wp930501"> </a>
      status = mgrclut(pal_id, palette_data)<a name="wp930502"> </a>
C<a name="wp930503"> </a>
C     Display the palette data.<a name="wp930504"> </a>
C<a name="wp930505"> </a>
      write(*,*) &quot;Palette data&quot;<a name="wp930506"> </a>
      do 10 i = 1, n_entries_out<a name="wp930507"> </a>
         write(*,*) (ichar(palette_data(j,i)), j = 1, n_comps)<a name="wp930508"> </a>
10    continue  <a name="wp930509"> </a>
C<a name="wp930510"> </a>
C     Terminate access to the raster image and to the GR interface,<a name="wp930511"> </a>
C     and close the HDF file.<a name="wp930512"> </a>
C<a name="wp930513"> </a>
      status = mgendac(ri_id)<a name="wp930514"> </a>
      status = mgend(gr_id)<a name="wp930515"> </a>
      status = hclose(file_id)<a name="wp930516"> </a>
      end<a name="wp930517"> </a>
</pre></div>
    </blockquote>

    <hr />

    <table id="SummaryNotReq2" border="0" width="850" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left">
        HDF4.2r4 - February 2009<br/>
        <a href="UG_Copyright.html">Copyright</a>
        <td align="right">
          <span style="font-size: 12px; font-weight: bold">
            The HDF Group<br />
          </span>
          <span style="font-size: 12px">
            <a href="http://www.hdfgroup.org">www.hdfgroup.org</a><br />
            <img valign="bottom" border="0" src="images/help.jpg" height="12" alt="The HDF Group" valign="top" />
          </span>
        </td>
      </tr>
    </table>

    <table id="SummaryNotReq3" width="220" border="0" cellpadding="0" cellspacing="0">
    </table>
  </body>
</html>
