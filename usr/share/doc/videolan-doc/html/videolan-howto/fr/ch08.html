<?xml version="1.0" encoding="iso-8859-15" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15" /><title>Chapter 8.  Diffusez depuis une carte d'acquisition ou une webcam</title><link rel="stylesheet" href="screen.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><meta name="keywords" content="VideoLAN, Client, vlc, VLC, vls, VLS, vod, sap, stream, multicast, MPEG-1, MPEG-2, MPEG-4, DVD, DVB, DivX" /><link rel="start" href="index.html" title="VideoLAN HOWTO" /><link rel="up" href="index.html" title="VideoLAN HOWTO" /><link rel="prev" href="ch07.html" title="Chapter 7.  Diffusez depuis une carte d'encodage MPEG" /><link rel="next" href="ch09.html" title="Chapter 9.  Utilisation avancée du stream output de VLC (transcodage, diffusion multiple, ...)" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 8. 

Diffusez depuis une carte d'acquisition ou 
une webcam
</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch09.html">Next</a></td></tr></table><hr /></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="softencoding"></a>Chapter 8. 

Diffusez depuis une carte d'acquisition ou 
une webcam
</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch08.html#id2575592">


Installez les drivers Video for Linux

</a></span></dt><dt><span class="sect1"><a href="ch08.html#id2576582">

Diffusez avec VLC

</a></span></dt><dt><span class="sect1"><a href="ch08.html#id2576877">

Diffusez avec VLS
</a></span></dt></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>

Ceci n'est possible que sous GNU/Linux


.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2575592"></a>


Installez les drivers Video for Linux

</h2></div></div></div><p>

Si vous désirez diffuser depuis une carte
d'acquisition ou une webcam, un driver video4linux doit
être disponible. Vous pouvez trouver plus d'informations
sur video4linux et les périphériques supportés <a class="ulink" href="http://www.exploits.org/v4l" target="_top">ici</a>



.</p><p>

Compilez le bon module pour votre périphérique,
et insérez le dans le noyau (certains modules video4linux sont livrés
avec les noyaux Linux 2.4.x). Vous pouvez tester votre périphérique,
en utilisant l'un des programmes de la section <span class="emphasis"><em>Video: TV and
PVR/DVR</em></span> de <a class="ulink" href="http://www.exploits.org/v4l/" target="_top">cette
page</a>



.</p><p>

Remarque: les modules v4l2 fonctionneront
également



.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2576582"></a>

Diffusez avec VLC

</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>

Vous devez ajouter <span class="command"><strong>--enable-v4l</strong></span> à
<span class="command"><strong>./configure</strong></span> pour celà



.</p></div><pre class="screen">

<code class="prompt">% </code><strong class="userinput"><code>vlc -vvv v4l:/dev/video:norm=secam:frequency=543250:size=640x480:channel=0:adev=/dev/dsp:audio=0
--sout '#transcode{vcodec=mp4v,acodec=mpga,vb=3000,ab=256,vt=800000,keyint=80,deinterlace}:std{access=udp,mux=ts,url=239.255.12.13}' --ttl 12</code></strong>
</pre><p>
où 


:</p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">/dev/video</code>

est l'adresse correspondant à votre carte
d'acquisition ou à votre webcam


,</p></li><li><p><span class="emphasis"><em>norm=secam</em></span>

est le nom du standard du signal analogique (celà
peut être pal, secam ou ntsc



,</p></li><li><p><span class="emphasis"><em>frequency=543250</em></span>

est la fréquence en kHz de la
chaîne(<span class="emphasis"><em>Attention:</em></span>avec VLC &lt; 0.6.1, la fréquence
est la fréquence du canal en MHz, multipliée par 16)


,</p></li><li><p>

<span class="emphasis"><em>size=640x480</em></span> est la taille
de la vidéo que vous désirez diffuser (vous pouvez également indiquer
une taille standard, telle que <span class="emphasis"><em>subqcif</em></span> (128x96),
<span class="emphasis"><em>qsif</em></span> (160x120), <span class="emphasis"><em>qcif</em></span>
(176x144), <span class="emphasis"><em>sif</em></span> (320x240), <span class="emphasis"><em>cif</em></span>
(352x288) ou <span class="emphasis"><em>vga</em></span> (640x480))


,</p></li><li><p><span class="emphasis"><em>channel=0</em></span> 

est le numéro du canal (généralement, 0 pour le
tuner, 1 pour le composite, et 2 pour Svidéo)



,</p></li><li><p><span class="emphasis"><em>adev=/dev/dsp</em></span>

est le périphérique audio


,</p></li><li><p><span class="emphasis"><em>audio=1</em></span> 

est le numéro du canal audio (généralement, 0 pour
mono et 1 pour stéréo)


,</p></li><li><p><span class="emphasis"><em>vcodec=mp4v</em></span> 

est le format d'encodage vidéo
(<span class="emphasis"><em>mp4v</em></span> pour MPEG-4, <span class="emphasis"><em>mpgv</em></span> pour
MPEG-1, mais aussi
<span class="emphasis"><em>h263</em></span>, <span class="emphasis"><em>DIV1</em></span>,
<span class="emphasis"><em>DIV2</em></span>, <span class="emphasis"><em>DIV3</em></span>,
<span class="emphasis"><em>I420</em></span>, <span class="emphasis"><em>I422</em></span>,
<span class="emphasis"><em>I444</em></span>, <span class="emphasis"><em>RV24</em></span>,
<span class="emphasis"><em>YUY2</em></span>),</p></li><li><p><span class="emphasis"><em>acodec=mpga</em></span> 

est le format audio d'encodage
(<span class="emphasis"><em>mpga</em></span> pour MPEG audio layer 2,
<span class="emphasis"><em>a52</em></span> pour A52 / AC3)


,</p></li><li><p><span class="emphasis"><em>vb=3000</em></span>

 est le taux de compression vidéo en Kbps


,</p></li><li><p><span class="emphasis"><em>ab=256</em></span>

 est le taux de compression audio en Kbps
</p></li><li><p><span class="emphasis"><em>vt=800000</em></span>

 est la tolérance sur le bitrate vidéo en bps


,</p></li><li><p><span class="emphasis"><em>keyint=80</em></span>

est le nombre maximal d'image entre deux images
"I"



,</p></li><li><p><span class="emphasis"><em>deinterlace</em></span>

pour désentrelacer le flux à la volée


,</p></li><li><p><span class="emphasis"><em>192.168.0.42</em></span>

 est soit 



:</p><div class="itemizedlist"><ul type="circle"><li><p>

l'adresse IP de la machine vers laquelle vous
désirez diffuser en unicast


;</p></li><li><p>

le nom DNS de la machine vers laquelle vous désirez
envoyer en unicast



;</p></li><li><p>

une adresse IP multicast


.</p></li></ul></div></li><li><p><span class="emphasis"><em>12</em></span>

 est la valeur du TTL (Time To Live) de vos paquets
IP (cela signifie qu'ils pourront traverser 11 routeurs)


.</p></li></ul></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2576877"></a>

Diffusez avec VLS
</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>

Vous devez avoir la version SVN de VLS. Quand vous
la compilez, vous devez utiliser <span class="command"><strong>./bootstrap</strong></span> puis
 <span class="command"><strong>./configure --enable-v4l
--with-ffmpeg=PATH</strong></span> (avec <span class="emphasis"><em>PATH</em></span> le chemin
absolu vers le répertoire où vous avez compilé ffmpeg, et non pas le
chemin relatif !)



.</p></div><p>

Il n'existe pas de ligne de commande pour ce
type d'entrée pour l'instant, vous devez utiliser le fichier de
configuration


.</p><p>

Voici un fichier <code class="filename">vls.cfg</code>typique
pour faire marcher VLS avec un périphérique v4l


:</p><pre class="programlisting">
# vls.cfg (VLS configuration file)
# Example of the VideoLAN HOWTO for the Video for Linux input

BEGIN "Inputs"

  webcam       = "v4l"

END

BEGIN "webcam"

  # V4L device
  Device        = "/dev/video"

  # Channel Source : Webcam is often "0"
  #                  TV Card, may be Tuner(0), Composite(1), Svideo(2)
  Channel       = "0"

  # Norm: PAL=0, NTSC=1, SECAM=2
  Norm          = "0"

  # Frequency of the channel in Mhz, multiplied by 16 (tuner cards only)
  Frequency     = "7668"

  # Size possibilities: can be either:
  # - empty string : default size
  # - width x height
  # - subQCIF(128x96), QSIF(160x120), QCIF(176x144), SIF(320x240),
  #   CIF(352x288), VGA (640x480)
  Size          = ""

  # DeInterlace: "0" = no ; "1" = yes
  DeInterlace   = "0"

  # Video compression format: "mpeg1" or "mpeg4"
  Compression   = "mpeg4"

  # Video bitrate (approx.) in kbps
  Bitrate       = "500"

  # Quality: "1.0" (good) to "31.0" (bad)
  Quality       = "1.0"

  # Sound device
  AudioDevice   = "/dev/dsp"

  # Audio compression format: "mp2", "mp3" or "ogg"
  AudioCompression = "mp2"

  # Audio bitrate in kpbs
  AudioBitrate  = "64"

  # Audio frequency ("16000", "22050", "24000", "32000", "44100" or "48000")
  AudioFreq     = "16000"

  # Audio channel: "1" = mono ; "2" = stereo
  AudioChannel  = "2"

END

BEGIN "Channels"

  channel1       = "network"

END

BEGIN "channel1"

  # Unicast or multicast IP address
  DstHost = "192.168.0.42"

  # Destination port
  DstPort = "1234"

  # If it's a multicast IP address, uncomment the line below
  #Type    = "multicast"

  # If it's a multicast IP address, set the "Time To Live" below
  #TTL     = "12"

END

BEGIN "LaunchOnStartUp"

  command1 = "start video channel1 webcam"

END
</pre><p>

Une fois que vous avez adapté ce fichier de
configuration, lancez VLS


:</p><pre class="screen">
<code class="prompt">% </code><strong class="userinput"><code>vls -vv -f vls.cfg</code></strong>
</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch09.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 7. 
Diffusez depuis une carte d'encodage MPEG
 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 9. 

Utilisation avancée du stream output de VLC
(transcodage, diffusion multiple, ...)


</td></tr></table></div></body></html>
