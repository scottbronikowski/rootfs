<?xml version="1.0" encoding="iso-8859-15" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15" /><title>Chapter 8.  Stream from an acquisition card or a webcam</title><link rel="stylesheet" href="screen.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><meta name="keywords" content="VideoLAN, Client, vlc, VLC, vls, VLS, vod, sap, stream, multicast, MPEG-1, MPEG-2, MPEG-4, DVD, DVB, DivX" /><link rel="start" href="index.html" title="VideoLAN HOWTO" /><link rel="up" href="index.html" title="VideoLAN HOWTO" /><link rel="prev" href="ch07.html" title="Chapter 7.  Stream from an MPEG encoding card" /><link rel="next" href="ch09.html" title="Chapter 9.  Advanced use of VLC's stream output (transcoding, multiple streaming, etc...)" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 8. 
Stream from an acquisition card or a webcam
</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch09.html">Next</a></td></tr></table><hr /></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="softencoding"></a>Chapter 8. 
Stream from an acquisition card or a webcam
</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch08.html#id2575566">
Install the Video for Linux drivers
</a></span></dt><dt><span class="sect1"><a href="ch08.html#id2575506">
Stream with VLC

</a></span></dt><dt><span class="sect1"><a href="ch08.html#id2576822">
Stream with VLS
</a></span></dt></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
This is possible under GNU/Linux only.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2575566"></a>
Install the Video for Linux drivers
</h2></div></div></div><p>
If you want to stream from an acquisition card
or a webcam, a video4linux driver must be available for it. You can
find more information about video4linux and supported devices <a class="ulink" href="http://www.exploits.org/v4l" target="_top">here</a>.
</p><p>
Compile the right module for your device, and insert
it into your kernel (Some video4linux modules are shipped with the 2.4.x
Linux kernels). You can test your device by using any of the listed
programs in the <span class="emphasis"><em>Video: TV and PVR/DVR</em></span> section of
<a class="ulink" href="http://www.exploits.org/v4l/" target="_top">this page</a>.
</p><p>
Note that v4l2 modules will also work with VLC.
</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2575506"></a>
Stream with VLC

</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
You must add <span class="command"><strong>--enable-v4l</strong></span> to
<span class="command"><strong>./configure</strong></span> to use this feature.
</p></div><pre class="screen">

<code class="prompt">% </code><strong class="userinput"><code>vlc -vvv v4l:/dev/video:norm=secam:frequency=543250:size=640x480:channel=0:adev=/dev/dsp:audio=0
--sout '#transcode{vcodec=mp4v,acodec=mpga,vb=3000,ab=256,vt=800000,keyint=80,deinterlace}:std{access=udp,mux=ts,url=239.255.12.13}' --ttl 12</code></strong>
</pre><p>where:
</p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">/dev/video</code>
 is the device corresponding to your acquisition
card or your webcam,
</p></li><li><p><span class="emphasis"><em>norm=secam</em></span>
 is name of the standard of the analogic signal
(possible values are pal, secam, and ntsc),

</p></li><li><p><span class="emphasis"><em>frequency=543250</em></span>
 is the frequency of the channel in kHz
(<span class="emphasis"><em>Warning :</em></span> for VLC &lt; 0.6.1, Frequency is channel
frequency in MHz multiplied by 16),
</p></li><li><p>
<span class="emphasis"><em>size=640x480</em></span>
is the size of the video you want (you can also put the
standard size like <span class="emphasis"><em>subqcif</em></span> (128x96),
<span class="emphasis"><em>qsif</em></span> (160x120), <span class="emphasis"><em>qcif</em></span>
(176x144), <span class="emphasis"><em>sif</em></span> (320x240), <span class="emphasis"><em>cif</em></span>
(352x288) or <span class="emphasis"><em>vga</em></span> (640x480)),
</p></li><li><p><span class="emphasis"><em>channel=0</em></span> 
is the number of the channel (usually 0 is for
tuner, 1 for composite and 2 for svideo),

</p></li><li><p><span class="emphasis"><em>adev=/dev/dsp</em></span>
is the audio device,
</p></li><li><p><span class="emphasis"><em>audio=1</em></span> 
is the number of the audio
channel (usually 0 is for mono and 1 for stereo),
</p></li><li><p><span class="emphasis"><em>vcodec=mp4v</em></span> 
is the video format you want to encode in
(<span class="emphasis"><em>mp4v</em></span> is MPEG-4, <span class="emphasis"><em>mpgv</em></span> is
MPEG-1, and there is also
<span class="emphasis"><em>h263</em></span>, <span class="emphasis"><em>DIV1</em></span>,
<span class="emphasis"><em>DIV2</em></span>, <span class="emphasis"><em>DIV3</em></span>,
<span class="emphasis"><em>I420</em></span>, <span class="emphasis"><em>I422</em></span>,
<span class="emphasis"><em>I444</em></span>, <span class="emphasis"><em>RV24</em></span>,
<span class="emphasis"><em>YUY2</em></span>),</p></li><li><p><span class="emphasis"><em>acodec=mpga</em></span> 
is the audio format you want to encode
in (<span class="emphasis"><em>mpga</em></span> is MPEG audio layer 2,
<span class="emphasis"><em>a52</em></span> is A52 i.e. AC3 sound),
</p></li><li><p><span class="emphasis"><em>vb=3000</em></span>
 is the video bitrate in Kbit/s

 es el bitrate de vídeo en Kbit/s
,
</p></li><li><p><span class="emphasis"><em>ab=256</em></span>
 is the audio bitrate in Kbit/s
</p></li><li><p><span class="emphasis"><em>vt=800000</em></span>
 is the video bitrate tolerance in bit/s,
</p></li><li><p><span class="emphasis"><em>keyint=80</em></span>
 is the maximum interval between two "I" images in
number of images,

</p></li><li><p><span class="emphasis"><em>deinterlace</em></span>
tells VLC to deinterlace the video on the fly,
</p></li><li><p><span class="emphasis"><em>192.168.0.42</em></span>
 is either:

</p><div class="itemizedlist"><ul type="circle"><li><p>
the IP address of the machine you want to unicast
to;
</p></li><li><p>
or the DNS name the machine you want to unicast
to;

</p></li><li><p>
or a multicast IP address.</p></li></ul></div></li><li><p><span class="emphasis"><em>12</em></span>
 is the value of the TTL (Time To
Live) of your IP packets (which means that the stream will be
able to cross 11 routers).</p></li></ul></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2576822"></a>
Stream with VLS
</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
You need the SVN version of VLS. When you
compile it, you must do a <span class="command"><strong>./bootstrap</strong></span> and
 <span class="command"><strong>./configure --enable-v4l
--with-ffmpeg=PATH</strong></span> (where <span class="emphasis"><em>PATH</em></span> is the
absolute path to the directory where you compiled ffmpeg, and not the
relative path !).
</p></div><p>
There is no command line interface for this input
for the moment, so you will have to use the configuration file.</p><p>
Here is a typical configuration file
<code class="filename">vls.cfg</code>to run VLS with a v4l device:
</p><pre class="programlisting">
# vls.cfg (VLS configuration file)
# Example of the VideoLAN HOWTO for the Video for Linux input

BEGIN "Inputs"

  webcam       = "v4l"

END

BEGIN "webcam"

  # V4L device
  Device        = "/dev/video"

  # Channel Source : Webcam is often "0"
  #                  TV Card, may be Tuner(0), Composite(1), Svideo(2)
  Channel       = "0"

  # Norm: PAL=0, NTSC=1, SECAM=2
  Norm          = "0"

  # Frequency of the channel in Mhz, multiplied by 16 (tuner cards only)
  Frequency     = "7668"

  # Size possibilities: can be either:
  # - empty string : default size
  # - width x height
  # - subQCIF(128x96), QSIF(160x120), QCIF(176x144), SIF(320x240),
  #   CIF(352x288), VGA (640x480)
  Size          = ""

  # DeInterlace: "0" = no ; "1" = yes
  DeInterlace   = "0"

  # Video compression format: "mpeg1" or "mpeg4"
  Compression   = "mpeg4"

  # Video bitrate (approx.) in kbps
  Bitrate       = "500"

  # Quality: "1.0" (good) to "31.0" (bad)
  Quality       = "1.0"

  # Sound device
  AudioDevice   = "/dev/dsp"

  # Audio compression format: "mp2", "mp3" or "ogg"
  AudioCompression = "mp2"

  # Audio bitrate in kpbs
  AudioBitrate  = "64"

  # Audio frequency ("16000", "22050", "24000", "32000", "44100" or "48000")
  AudioFreq     = "16000"

  # Audio channel: "1" = mono ; "2" = stereo
  AudioChannel  = "2"

END

BEGIN "Channels"

  channel1       = "network"

END

BEGIN "channel1"

  # Unicast or multicast IP address
  DstHost = "192.168.0.42"

  # Destination port
  DstPort = "1234"

  # If it's a multicast IP address, uncomment the line below
  #Type    = "multicast"

  # If it's a multicast IP address, set the "Time To Live" below
  #TTL     = "12"

END

BEGIN "LaunchOnStartUp"

  command1 = "start video channel1 webcam"

END
</pre><p>
Once you have adapted the configuration file above,
run VLS:
</p><pre class="screen">
<code class="prompt">% </code><strong class="userinput"><code>vls -vv -f vls.cfg</code></strong>
</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch09.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 7. 

Stream from an MPEG encoding card
 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 9. 
Advanced use of VLC's stream output
(transcoding, multiple streaming, etc...)
</td></tr></table></div></body></html>
